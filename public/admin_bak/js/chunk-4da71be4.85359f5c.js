(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4da71be4"],{2927:function(e,t,r){},"2b8e":function(e,t,r){"use strict";r.d(t,"m",(function(){return n})),r.d(t,"n",(function(){return a})),r.d(t,"a",(function(){return l})),r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"k",(function(){return f})),r.d(t,"l",(function(){return d})),r.d(t,"f",(function(){return h})),r.d(t,"i",(function(){return p})),r.d(t,"j",(function(){return v})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return m}));var i=r("f175"),n=function(){return i["a"].get("settings.delivery.delivery_way/getConfig")},a=function(e){return i["a"].post("settings.delivery.delivery_way/setConfig",e)},l=function(e){return i["a"].post("/settings.delivery.express/add",e)},s=function(e){return i["a"].post("/settings.delivery.express/edit",e)},o=function(e){return i["a"].post("/settings.delivery.express/del",e)},c=function(e){return i["a"].get("/settings.delivery.express/detail",{params:e})},u=function(e){return i["a"].get("/settings.delivery.express/lists",{params:e})},f=function(){return i["a"].get("settings.delivery.logistics_config/getLogisticsConfig")},d=function(e){return i["a"].post("settings.delivery.logistics_config/setLogisticsConfig",e)},h=function(e){return i["a"].post("settings.delivery.freight/add",e)},p=function(e){return i["a"].post("settings.delivery.freight/edit",e)},v=function(e){return i["a"].get("settings.delivery.freight/lists",{params:e})},g=function(e){return i["a"].get("settings.delivery.freight/detail",{params:e})},m=function(e){return i["a"].post("settings.delivery.freight/del",e)}},"550a":function(e,t,r){"use strict";r("fefb")},"780f":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"freight-edit flex-col"},[r("div",{staticClass:"ls-card freight-edit__header"},[r("el-page-header",{attrs:{content:e.id?"编辑运费模板":"新增运费模板"},on:{back:function(t){return e.$router.go(-1)}}})],1),r("div",{staticClass:"ls-card freight-edit__form m-t-10"},[r("el-form",{ref:"form",staticClass:"ls-form",attrs:{model:e.form,"label-width":"120px",size:"small"}},[r("el-form-item",{attrs:{label:"模板名称",prop:"name",required:"",rules:[{required:!0,message:"请输入模板名称",trigger:["blur","change"]}]}},[r("el-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"计费方式",required:""}},[r("el-radio-group",{model:{value:e.form.charge_way,callback:function(t){e.$set(e.form,"charge_way",t)},expression:"form.charge_way"}},[r("el-radio",{attrs:{label:1}},[e._v("件数计费")]),r("el-radio",{attrs:{label:2}},[e._v("重量计费")]),r("el-radio",{attrs:{label:3}},[e._v("体积计费")])],1),r("div",{staticClass:"muted"},[e._v("保存后计费方式不能更改")])],1),r("el-form-item",{attrs:{label:"配送区域",required:""}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.region,size:"mini"}},[r("el-table-column",{attrs:{label:"配送区域",prop:"region_name","min-width":"300"}}),r("el-table-column",{attrs:{"min-width":"150",label:"首"+e.getTableTitle},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticClass:"p-t-8 p-b-8",staticStyle:{width:"90%"},attrs:{type:"number"},model:{value:t.row.first_unit,callback:function(r){e.$set(t.row,"first_unit",r)},expression:"scope.row.first_unit"}})]}}])}),r("el-table-column",{attrs:{"min-width":"150",label:"运费（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticClass:"p-t-8 p-b-8",staticStyle:{width:"90%"},attrs:{type:"number"},model:{value:t.row.first_money,callback:function(r){e.$set(t.row,"first_money",r)},expression:"scope.row.first_money"}})]}}])}),r("el-table-column",{attrs:{"min-width":"150",label:"续"+e.getTableTitle},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticClass:"p-t-8 p-b-8",staticStyle:{width:"90%"},attrs:{type:"number"},model:{value:t.row.continue_unit,callback:function(r){e.$set(t.row,"continue_unit",r)},expression:"scope.row.continue_unit"}})]}}])}),r("el-table-column",{attrs:{"min-width":"150",label:"续费（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticClass:"p-t-8 p-b-8",staticStyle:{width:"90%"},attrs:{type:"number"},model:{value:t.row.continue_money,callback:function(r){e.$set(t.row,"continue_money",r)},expression:"scope.row.continue_money"}})]}}])}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return t.$index>0?[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleEdit(t.row.area_id)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleDelete(t.row.area_id)}}},[e._v("删除")])]:void 0}}],null,!0)})],1)],1),r("el-form-item",[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleShowDelivery}},[e._v("指定配送区域和运费")]),r("span",{staticClass:"muted m-l-10"},[e._v("根据件数来计算运费，当物品不足《首件数量》时，按照《首件费用》计算，超过部分按照《续件件数》和《续件费用》乘积来计算")])],1),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{rows:"8",type:"textarea",placeholder:"请输入备注内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),r("delivery-area",{ref:"deliveryArea",attrs:{"area-id":e.areaId,"default-region":e.form.region},on:{change:e.areaChange}})],1),r("div",{staticClass:"freight-edit__footer bg-white ls-fixed-footer"},[r("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[r("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)])])},n=[],a=r("d4ec"),l=r("bee2"),s=r("262e"),o=r("2caf"),c=(r("c740"),r("a434"),r("a15b"),r("d81d"),r("159b"),r("9ab4")),u=r("1b40"),f=r("0463"),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"delivery-area"},[r("ls-dialog",{ref:"dialog",attrs:{title:"区域选择",width:"900px",top:"20vh"},on:{confirm:e.onConfirm}},[r("div",{staticClass:"area-content flex col-stretch"},[r("div",{staticClass:"area-content__left flex-1"},[r("div",{staticClass:"flex row-between area-title"},[r("div",{staticClass:"normal nr"},[e._v("地区选择")]),r("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入地区关键字"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),r("area-panel",{ref:"panelAll",attrs:{option:e.areaLists,"filter-text":e.filterText,"area-id":e.areaId},on:{select:e.onSelect}})],1),r("div",{staticClass:"area-content__center flex row-center"},[r("i",{staticClass:"el-icon-arrow-right font-size-30"})]),r("div",{staticClass:"area-content__right flex-1"},[r("div",{staticClass:"flex row-between area-title"},[r("div",{staticClass:"normal nr"},[e._v("已选择")])]),r("div",{staticClass:"select-area-list"},[r("area-panel",{ref:"panelSelect",attrs:{option:e.areaLists,"area-id":e.areaId,type:"select"},on:{cancel:e.onCancel}})],1)])])])],1)},h=[],p=r("2909"),v=(r("4de4"),r("caad"),r("2532"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"area-panel"},[r("el-scrollbar",{staticClass:"ls-scrollbar",staticStyle:{height:"450px"}},[r("div",{staticClass:"area-tree"},[r("el-tree",{ref:"tree",attrs:{"node-key":"value",data:e.option,"icon-class":"el-icon-arrow-right","filter-node-method":e.filterMethod},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,n=t.data;return r("div",{staticClass:"flex flex-1"},[r("span",{staticClass:"flex-1"},[e._v(e._s(i.label))]),r("div",{staticClass:"flex-none m-r-10"},["select"==e.type?r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onCancel(i,n)}}},[e._v(" 取消 ")]):r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),e.onSelect(i,n)}}},[e._v(" 选择 ")])],1)])}}])})],1)])],1)}),g=[],m=r("0a6d"),b=function(e){Object(s["a"])(r,e);var t=Object(o["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.apply(this,arguments),e.filterMethod=function(t,r){return"select"==e.type?!(!r.select||r.areaId!=e.areaId):!r.select&&(!e.isSelectAll(r)&&(!t||-1!==r.label.indexOf(t)))},e}return Object(l["a"])(r,[{key:"filterTextChange",value:function(e){this.$refs.tree.filter(e)}},{key:"areaIdChange",value:function(){this.filter()}},{key:"onSelect",value:function(e,t){this.selectChildren(e,!0),this.filter(),this.$emit("select")}},{key:"onCancel",value:function(e,t){this.selectChildren(e,!1),this.filter(),this.$emit("cancel")}},{key:"filter",value:function(){console.log(this.areaId,this.option,this.type),this.$refs.tree.filter()}},{key:"selectChildren",value:function(e,t){var r=this,i=e.data,n=e.childNodes;if(!n.length)return i.areaId&&i.areaId!=this.areaId||(i.select=t),void(i.areaId=i.areaId?t?i.areaId:0:this.areaId);n.forEach((function(e){r.selectChildren(e,t)}))}},{key:"isSelectAll",value:function(e){var t=this;return e.children?e.children.every((function(e){return t.isSelectAll(e)})):e.select}},{key:"mounted",value:function(){this.filter()}}]),r}(u["e"]);Object(c["a"])([Object(u["c"])({default:function(){}})],b.prototype,"option",void 0),Object(c["a"])([Object(u["c"])()],b.prototype,"type",void 0),Object(c["a"])([Object(u["c"])()],b.prototype,"filterText",void 0),Object(c["a"])([Object(u["c"])()],b.prototype,"areaId",void 0),Object(c["a"])([Object(u["f"])("filterText")],b.prototype,"filterTextChange",null),Object(c["a"])([Object(u["f"])("areaId")],b.prototype,"areaIdChange",null),b=Object(c["a"])([Object(u["a"])({components:{LsDialog:m["a"]}})],b);var y=b,_=y,k=(r("f638"),r("2877")),w=Object(k["a"])(_,v,g,!1,null,"45981e74",null),x=w.exports,C=r("6ddb"),j=function(e){Object(s["a"])(r,e);var t=Object(o["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.apply(this,arguments),e.isFirst=!0,e.filterText="",e.areaLists=JSON.parse(JSON.stringify(f["a"])),e.onConfirm=Object(C["h"])((function(){var t=e.getSelectArea(e.areaLists);e.$emit("change",t)})),e}return Object(l["a"])(r,[{key:"defaultRegionChange",value:function(e){var t=this;this.isFirst&&(this.isFirst=!1,e.forEach((function(e){t.setSelectArea(e,t.areaLists)})))}},{key:"show",value:function(){var e;null===(e=this.$refs.dialog)||void 0===e||e.onTrigger()}},{key:"onSelect",value:function(){this.$refs.panelSelect.filter()}},{key:"onCancel",value:function(){this.$refs.panelAll.filter()}},{key:"getSelectArea",value:function(e){var t=this,r=[];return e.forEach((function(e){var i=[];e.children&&e.children.forEach((function(e){var n=e.children.filter((function(e){return e.select&&e.areaId==t.areaId}));e.children.length==n.length?i.push(e):r.push.apply(r,Object(p["a"])(n))})),i.length==e.children.length?r.push(e):r.push.apply(r,i)})),r}},{key:"clearSelectArea",value:function(e){for(var t in e=e||this.areaLists,e)e[t].select&&e[t].areaId==this.areaId&&(console.log(this.areaId),e[t].select=!1,e[t].areaId=0),e[t].children&&this.clearSelectArea(e[t].children)}},{key:"setSelectArea",value:function(e,t){t.forEach((function(t){t.children&&t.children.forEach((function(r){r.children&&r.children.forEach((function(i){(e.region_id.includes(t.value)||e.region_id.includes(r.value)||e.region_id.includes(i.value))&&(i.select=!0,i.areaId=e.area_id)}))}))}))}},{key:"mounted",value:function(){console.log(this.$refs)}}]),r}(u["e"]);Object(c["a"])([Object(u["c"])()],j.prototype,"areaId",void 0),Object(c["a"])([Object(u["c"])()],j.prototype,"defaultRegion",void 0),Object(c["a"])([Object(u["f"])("defaultRegion")],j.prototype,"defaultRegionChange",null),j=Object(c["a"])([Object(u["a"])({components:{AreaPanel:x,LsDialog:m["a"]}})],j);var O=j,S=O,I=(r("be40"),Object(k["a"])(S,d,h,!1,null,"0e9b4898",null)),$=I.exports,A=r("2b8e"),T=function(e){Object(s["a"])(r,e);var t=Object(o["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.apply(this,arguments),e.areaLists=f["a"],e.form={name:"",charge_way:1,remark:"",region:[{area_id:"",region_id:"100000",region_name:"全国统一运费",first_unit:"",first_money:"",continue_unit:"",continue_money:""}]},e.areaId="",e}return Object(l["a"])(r,[{key:"getTableTitle",get:function(){var e=this.form.charge_way;switch(e){case 1:return"件（件）";case 2:return"重（Kg）";case 3:return"体积（m³）"}}},{key:"checkRegion",get:function(){var e=this.form.region.every((function(e){return e.region_id&&""!==e.first_unit&&""!==e.first_unit&&""!==e.first_unit&&""!==e.first_unit}));return e||this.$message.error("填写完整运费模板"),e}},{key:"handleShowDelivery",value:function(){this.areaId=Object(C["f"])(),this.$refs.deliveryArea.show()}},{key:"handleEdit",value:function(e){this.areaId=e,this.$refs.deliveryArea.show()}},{key:"handleDelete",value:function(e){var t=this;this.areaId=e;var r=this.form.region.findIndex((function(t){return t.area_id==e}));-1!=r&&this.form.region.splice(r,1),this.$nextTick((function(){t.$refs.deliveryArea.clearSelectArea()}))}},{key:"areaChange",value:function(e){var t=this,r=this.form.region.findIndex((function(e){return e.area_id==t.areaId})),i=e.map((function(e){return e.value})).join(),n=e.map((function(e){return e.label})).join("、");if(-1!=r)return this.form.region[r].region_id=i,void(this.form.region[r].region_name=n);this.form.region.push({area_id:this.areaId,region_id:i,region_name:n,first_unit:"",first_money:"",continue_unit:"",continue_money:""})}},{key:"handleSave",value:function(){var e=this;this.$refs.form.validate((function(t){if(!t||!e.checkRegion)return!1;var r=e.id?Object(A["i"])(e.form):Object(A["f"])(e.form);r.then((function(){e.$router.go(-1)}))}))}},{key:"getFreightDetail",value:function(){var e=this;Object(A["h"])({id:this.id}).then((function(t){t.region.forEach((function(e){e.area_id=Object(C["f"])()})),e.form=t,console.log(e.form)}))}},{key:"created",value:function(){this.id=this.$route.query.id,this.id&&this.getFreightDetail()}}]),r}(u["e"]);T=Object(c["a"])([Object(u["a"])({components:{DeliveryArea:$,LsDialog:m["a"]}})],T);var E=T,L=E,z=(r("550a"),Object(k["a"])(L,i,n,!1,null,"6175cbf4",null));t["default"]=z.exports},be40:function(e,t,r){"use strict";r("d713")},c740:function(e,t,r){"use strict";var i=r("23e7"),n=r("b727").findIndex,a=r("44d2"),l="findIndex",s=!0;l in[]&&Array(1)[l]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a(l)},d713:function(e,t,r){},d81d:function(e,t,r){"use strict";var i=r("23e7"),n=r("b727").map,a=r("1dde"),l=a("map");i({target:"Array",proto:!0,forced:!l},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},f638:function(e,t,r){"use strict";r("2927")},fefb:function(e,t,r){}}]);
//# sourceMappingURL=chunk-4da71be4.85359f5c.js.map