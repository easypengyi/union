(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3390748f"],{"0f8c":function(e,t,a){},"1bf1":function(e,t,a){},"31d6":function(e,t,a){},"40df":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"live-broadcast-edit"},[a("div",{staticClass:"ls-card"},[a("el-page-header",{attrs:{content:"add"===e.mode?"新建直播间":""},on:{back:function(t){return e.$router.go(-1)}}})],1),a("el-form",{ref:"formRef",attrs:{rules:e.formRules,model:e.form,"label-width":"120px",size:"small"}},[a("div",{staticClass:"ls-card m-t-16"},[a("div",{staticClass:"card-content m-t-24"},[a("el-form-item",{attrs:{label:"直播间标题",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入直播标题"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"直播类型",prop:"type"}},[a("el-radio-group",{staticClass:"m-r-16",model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{staticClass:"m-r-16",attrs:{label:0}},[e._v("手机直播")])],1),a("div",{staticClass:"muted xs m-r-16"},[e._v(" 通过“小程序直播/推流设备”开播 ")])],1),a("el-form-item",{attrs:{label:"开播时间",prop:""}},[a("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetime",placeholder:"请输入开播时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}),a("div",{staticClass:"muted xs m-r-16"},[e._v(" 填写直播开始时间，开播时间需要在当前时间的10分钟后并且不能在6个月后 ")])],1),a("el-form-item",{attrs:{label:"结束时间",prop:""}},[a("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetime",placeholder:"请输入结束时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}),a("div",{staticClass:"muted xs m-r-16"},[e._v(" 开播时间和结束时间间隔不得短于30分钟，不得超过24小时 ")])],1),a("el-form-item",{attrs:{label:"主播昵称",prop:"anchor_name"}},[a("el-input",{attrs:{placeholder:"请输入主播昵称"},model:{value:e.form.anchor_name,callback:function(t){e.$set(e.form,"anchor_name",t)},expression:"form.anchor_name"}})],1),a("el-form-item",{attrs:{label:"主播微信号",prop:"anchor_wechat"}},[a("el-input",{attrs:{placeholder:"请输入主播微信号"},model:{value:e.form.anchor_wechat,callback:function(t){e.$set(e.form,"anchor_wechat",t)},expression:"form.anchor_wechat"}}),a("div",{staticClass:"muted xs m-r-16"},[e._v(" 每个直播间需要绑定主播微信号身份，用以核实主播身份，不会展示给观众。 ")])],1),a("el-form-item",{attrs:{label:"分享卡片封面",prop:"share_img"}},[a("live-upload",{on:{setImage:e.setShareImg}}),a("div",{staticClass:"muted xs m-r-16"},[e._v("用户在微信对话框内分享的直播间将以分享卡片的形式呈现。")]),a("div",{staticClass:"muted xs m-r-16"},[e._v("建议尺寸：800像素 * 640像素，图片大小不得超过1M。")])],1),a("el-form-item",{attrs:{label:"直播卡片封面",prop:"feeds_img"}},[a("live-upload",{on:{setImage:e.setFeedsImg}}),a("div",{staticClass:"muted xs m-r-16"},[e._v("图片建议大小为 800像素 * 800像素。图片大小不超过300KB。")])],1),a("el-form-item",{attrs:{label:"直播间背景墙",prop:"cover_img"}},[a("live-upload",{on:{setImage:e.setCoverImg}}),a("div",{staticClass:"muted xs m-r-16"},[e._v("直播间背景墙是每个直播间的默认背景。 建议尺寸：600像素 * 1300像素，图片大小不得超过3M")])],1),a("el-form-item",{attrs:{label:"直播间功能",prop:""}},[a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_like,callback:function(t){e.$set(e.form,"close_like",t)},expression:"form.close_like"}},[e._v("开启点赞")]),a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_goods,callback:function(t){e.$set(e.form,"close_goods",t)},expression:"form.close_goods"}},[e._v("开启货架")]),a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_comment,callback:function(t){e.$set(e.form,"close_comment",t)},expression:"form.close_comment"}},[e._v("开启评论")]),a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_replay,callback:function(t){e.$set(e.form,"close_replay",t)},expression:"form.close_replay"}},[e._v("开启回放")]),a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_share,callback:function(t){e.$set(e.form,"close_share",t)},expression:"form.close_share"}},[e._v("开启分享")]),a("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_kf,callback:function(t){e.$set(e.form,"close_kf",t)},expression:"form.close_kf"}},[e._v("开启客服")]),a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.form.is_feeds_public,callback:function(t){e.$set(e.form,"is_feeds_public",t)},expression:"form.is_feeds_public"}},[e._v("开启官方收录 ")])],1)],1)])]),a("div",{staticClass:"bg-white ls-fixed-footer"},[a("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("保存")])],1)])],1)},s=[],l=a("d4ec"),r=a("bee2"),o=a("262e"),n=a("2caf"),c=a("9ab4"),d=a("1b40"),u=a("4201"),m=a("b3ad"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("el-upload",{class:e.ishide?"hide":"",attrs:{action:e.action,headers:{token:e.$store.getters.token,version:e.version},"list-type":"picture-card",limit:1,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError}},[a("i",{staticClass:"el-icon-plus"})])],1)},p=[],h=(a("b0c0"),a("d70b")),b=function(e){Object(o["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.action="".concat(h["a"].baseURL,"/adminapi/upload/wechatMaterial"),e.version=h["a"].version,e.ishide=!1,e}return Object(r["a"])(a,[{key:"handleRemove",value:function(e,t){console.log("删除成功",e,t),this.ishide=!1}},{key:"handleSuccess",value:function(e,t,a){this.$emit("setImage",e.data.media_id),console.log("上传成功",e),this.ishide=!0}},{key:"handleError",value:function(e,t){this.$message.error("".concat(t.name,"文件上传失败"))}},{key:"handleExceed",value:function(){this.$message.error("超出上传上限，请重新上传")}}]),a}(d["e"]);b=Object(c["a"])([Object(d["a"])({components:{}})],b);var v=b,g=v,_=(a("eabd"),a("2877")),k=Object(_["a"])(g,f,p,!1,null,"4d6cc57c",null),y=k.exports,x=a("623a"),O=function(e){Object(o["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.pickerOptions={shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},e.mode=u["f"]["ADD"],e.form={type:0,name:"",start_time:0,end_time:0,anchor_name:"",anchor_wechat:"",cover_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",share_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",feeds_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",is_feeds_public:0,close_like:0,close_goods:0,close_comment:0,close_replay:0,close_share:0,close_kf:0},e.start="",e.end="",e.formRules={type:[{required:!0,message:"请选择直播类型",trigger:"change"}],name:[{required:!0,message:"请输入直播标题",trigger:"blur"}],start_time:[{required:!0,message:"请选择直播开始时间",trigger:"change"}],end_time:[{required:!0,message:"请选择直播结束时间",trigger:"change"}],anchor_name:[{required:!0,message:"请输入主播昵称",trigger:"blur"}],anchor_wechat:[{required:!0,message:"请输入主播微信号",trigger:"blur"}],cover_img:[{required:!0,message:"请选择直播间背景墙图片",trigger:"blur"}],share_img:[{required:!0,message:"请选择分享卡片封面图片",trigger:"blur"}],feeds_img:[{required:!0,message:"请选择直播卡片封面图片",trigger:"blur"}]},e}return Object(r["a"])(a,[{key:"setCoverImg",value:function(e){this.form.cover_img=e}},{key:"setShareImg",value:function(e){this.form.share_img=e}},{key:"setFeedsImg",value:function(e){this.form.feeds_img=e}},{key:"onSubmit",value:function(){var e=this;this.$refs.formRef.validate((function(t){t&&(console.log("发送请求"),e.liveRoomAdd())}))}},{key:"liveRoomAdd",value:function(){var e=this,t=new Date(this.start);this.form.start_time=t.getTime()/1e3;var a=new Date(this.end);this.form.end_time=a.getTime()/1e3,Object(x["d"])(this.form).then((function(t){setTimeout((function(){return e.$router.go(-1)}),500)})).catch((function(e){console.log("err:",e)}))}}]),a}(d["e"]);O=Object(c["a"])([Object(d["a"])({components:{MaterialSelect:m["a"],LiveUpload:y}})],O);var j=O,w=j,C=(a("bfc3"),Object(_["a"])(w,i,s,!1,null,"0428d5db",null));t["default"]=C.exports},"568b":function(e,t,a){"use strict";a("31d6")},"623a":function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return c}));var i=a("f175"),s=function(e){return i["a"].get("/live.LiveRoom/lists",{params:e})},l=function(e){return i["a"].post("/live.LiveRoom/add",e)},r=function(e){return i["a"].post("/live.LiveRoom/del",e)},o=function(e){return i["a"].get("/live.LiveGoods/lists",{params:e})},n=function(e){return i["a"].post("/live.LiveGoods/add",e)},c=function(e){return i["a"].post("/live.LiveGoods/del",e)}},b3ad:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ls-dialog",{ref:"materialDialog",staticClass:"material-select",attrs:{title:"选择"+e.tipsText,width:"1050px",top:"15vh"},on:{confirm:e.handleConfirm}},[e.hiddenTrigger?e._e():a("div",{staticClass:"material-select__trigger clearfix",attrs:{slot:"trigger"},on:{click:function(e){e.stopPropagation()}},slot:"trigger"},[a("draggable",{staticClass:"ls-draggable",attrs:{animation:"300",disabled:e.disabled||e.dragDisabled},on:{update:e.handleChange},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},e._l(e.fileList,(function(t,i){return a("div",{key:t+i,staticClass:"material-preview ls-del-wrap",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!1,i)}}},[e.$scopedSlots.preview?a("div",[e._t("preview",null,{item:e.imageUri(t)})],2):a("file-item",{attrs:{type:e.type,item:{uri:e.imageUri(t)},size:e.size}}),e.enableDelete?a("i",{staticClass:"el-icon-close ls-icon-del",on:{click:function(t){return t.stopPropagation(),e.delImage(i)}}}):e._e()],1)})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpload,expression:"showUpload"}],staticClass:"material-upload",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!0)}}},[e.$slots.upload?a("div",[e._t("upload")],2):a("div",{staticClass:"upload-btn flex row-center",style:{width:e.size+"px",height:e.size+"px",background:e.uploadBg}},[e._t("default"),e.$slots.default?e._e():a("span",[e._v("添加"+e._s(e.tipsText))])],2)])],1),a("div",{staticClass:"material-wrap"},[a("ls-material",{ref:"material",attrs:{"page-size":15,type:e.type,limit:e.meterialLimit},on:{change:e.selectChange}})],1)])},s=[],l=a("d4ec"),r=a("bee2"),o=a("262e"),n=a("2caf"),c=(a("d81d"),a("a434"),a("99af"),a("9ab4")),d=a("1b40"),u=a("0a6d"),m=a("c6fe"),f=a("e915"),p=a("b76a"),h=a.n(p),b=function(e){Object(o["a"])(a,e);var t=Object(n["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.isAdd=!0,e.fileList=[],e}return Object(r["a"])(a,[{key:"showUpload",get:function(){var e=this.fileList,t=this.limit;return t-e.length>0}},{key:"meterialLimit",get:function(){return this.isAdd?this.limit?this.limit-this.fileList.length:null:1}},{key:"tipsText",get:function(){switch(this.type){case"image":return"图片";case"video":return"视频"}}},{key:"imageUri",get:function(){var e=this;return function(t){return e.enableDomain?t:e.$getImageUri(t)}}},{key:"valueChange",value:function(e){this.fileList=Array.isArray(e)?e:""==e?[]:[e]}},{key:"showDialog",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1?arguments[1]:void 0;this.disabled||(this.isAdd=t,void 0!==a&&(this.currentIndex=a),null===(e=this.$refs.materialDialog)||void 0===e||e.onTrigger())}},{key:"selectChange",value:function(e){this.select=e}},{key:"handleConfirm",value:function(){var e=this;this.$refs.material.clearSelectList();var t=this.select.map((function(t){return e.enableDomain?t.uri:t.url}));this.isAdd?this.fileList=this.fileList.concat(t):this.fileList.splice(this.currentIndex,1,t.shift()),this.handleChange()}},{key:"delImage",value:function(e){this.fileList.splice(e,1),this.handleChange()}},{key:"handleChange",value:function(){var e=1!=this.limit?this.fileList:this.fileList[0]||"";this.$emit("input",e),this.$emit("change",e),this.fileList=[]}}]),a}(d["e"]);Object(c["a"])([Object(d["c"])({default:function(){return[]}})],b.prototype,"value",void 0),Object(c["a"])([Object(d["c"])({default:1})],b.prototype,"limit",void 0),Object(c["a"])([Object(d["c"])({default:"100"})],b.prototype,"size",void 0),Object(c["a"])([Object(d["c"])({default:!1})],b.prototype,"disabled",void 0),Object(c["a"])([Object(d["c"])({default:!1})],b.prototype,"dragDisabled",void 0),Object(c["a"])([Object(d["c"])({default:!1})],b.prototype,"hiddenTrigger",void 0),Object(c["a"])([Object(d["c"])({default:"image"})],b.prototype,"type",void 0),Object(c["a"])([Object(d["c"])({default:"transparent"})],b.prototype,"uploadBg",void 0),Object(c["a"])([Object(d["c"])({default:!0})],b.prototype,"enableDomain",void 0),Object(c["a"])([Object(d["c"])({default:!0})],b.prototype,"enableDelete",void 0),Object(c["a"])([Object(d["f"])("value",{immediate:!0})],b.prototype,"valueChange",null),b=Object(c["a"])([Object(d["a"])({components:{LsDialog:u["a"],LsMaterial:m["a"],Draggable:h.a,FileItem:f["a"]}})],b);var v=b,g=v,_=(a("568b"),a("2877")),k=Object(_["a"])(g,i,s,!1,null,"1503bff6",null);t["a"]=k.exports},bfc3:function(e,t,a){"use strict";a("1bf1")},eabd:function(e,t,a){"use strict";a("0f8c")}}]);
//# sourceMappingURL=chunk-3390748f.17d4dcab.js.map