(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8ba82336"],{"2c6e":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ls-add-role"},[n("div",{staticClass:"ls-card"},[n("el-page-header",{attrs:{content:"编辑角色"},on:{back:function(e){return t.$router.go(-1)}}})],1),n("div",{staticClass:"ls-card m-t-10"},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",size:"small"}},[n("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[n("el-input",{staticClass:"ls-input",attrs:{maxlength:"8","show-word-limit":"",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{staticClass:"ls-input",attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"请描述一下该角色"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),n("el-form-item",{attrs:{label:"权限"}},[n("el-tree",{ref:"permissionsTree",attrs:{data:t.permissionsTree,"node-key":"auth_key","default-expand-all":"","icon-class":"el-icon-arrow-right",props:{children:"sons",label:"name"},"empty-text":"","show-checkbox":""},on:{"check-change":t.handlePermissionsCheckChange}})],1)],1)],1),n("div",{staticClass:"bg-white ls-fixed-footer"},[n("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[n("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("保存")])],1)])])},i=[],a=n("5530"),o=n("d4ec"),s=n("bee2"),u=n("262e"),c=n("2caf"),l=(n("c740"),n("a434"),n("d81d"),n("b64b"),n("9ab4")),d=n("1b40"),f=n("68eb"),h=n("4201"),m=function(t){Object(u["a"])(n,t);var e=Object(c["a"])(n);function n(){var t;return Object(o["a"])(this,n),t=e.apply(this,arguments),t.mode=h["f"]["ADD"],t.identity=null,t.form={name:"",auth_keys:[],desc:""},t.permissionsTree=[],t.rules={name:[{required:!0,message:"必填项不可为空",trigger:"blur"}]},t}return Object(s["a"])(n,[{key:"handlePermissionsCheckChange",value:function(t,e){if(console.log(t),t.auth_key){var n=this.form.auth_keys.findIndex((function(e){return e==t.auth_key}));e?-1==n&&this.form.auth_keys.push(t.auth_key):-1!=n&&this.form.auth_keys.splice(n,1)}}},{key:"submitForm",value:function(t){var e=this,n=this.$refs[t];n.validate((function(t){if(!t)return e.$message.error("请完善信息");switch(e.mode){case h["f"]["ADD"]:return e.handleRoleAdd();case h["f"]["EDIT"]:return e.handleRoleEdit()}}))}},{key:"handleRoleAdd",value:function(){var t=this,e=this.form;Object(f["g"])(e).then((function(){setTimeout((function(){return t.$router.go(-1)}),500)})).catch((function(){}))}},{key:"handleRoleEdit",value:function(){var t=this,e=this.form,n=this.identity;Object(f["j"])(Object(a["a"])(Object(a["a"])({},e),{},{id:n})).then((function(){setTimeout((function(){return t.$router.go(-1)}),500)})).catch((function(){}))}},{key:"initFormDataForRoleEdit",value:function(){var t=this,e=this.identity;Object(f["i"])({id:e}).then((function(e){Object.keys(e).map((function(n){t.$set(t.form,n,e[n])})),t.form.auth_keys=[];var n=t.$refs["permissionsTree"];n.setCheckedKeys(e.auth_keys)})).catch((function(){}))}},{key:"getAuthMenu",value:function(){var t=this;Object(f["f"])().then((function(e){t.permissionsTree=e}))}},{key:"created",value:function(){var t=this.$route.query;t.mode&&(this.mode=t.mode),this.mode===h["f"]["EDIT"]&&(this.identity=1*t.id,this.initFormDataForRoleEdit()),this.getAuthMenu()}}]),n}(d["e"]);m=Object(l["a"])([d["a"]],m);var p=m,b=p,v=(n("9c5b"),n("2877")),y=Object(v["a"])(b,r,i,!1,null,"d898fef8",null);e["default"]=y.exports},"4cd1":function(t,e,n){},"68eb":function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"k",(function(){return c})),n.d(e,"i",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"j",(function(){return f})),n.d(e,"h",(function(){return h})),n.d(e,"f",(function(){return m}));var r=n("f175"),i=function(t){return r["a"].get("/auth.admin/lists",{params:t})},a=function(t){return r["a"].get("/auth.admin/detail",{params:t})},o=function(t){return r["a"].post("/auth.admin/add",t)},s=function(t){return r["a"].post("/auth.admin/delete",t)},u=function(t){return r["a"].post("/auth.admin/edit",t)},c=function(t){return r["a"].get("/auth.role/lists",{params:t})},l=function(t){return r["a"].get("/auth.role/detail",{params:t})},d=function(t){return r["a"].post("/auth.role/add",t)},f=function(t){return r["a"].post("/auth.role/edit",t)},h=function(t){return r["a"].post("/auth.role/delete",t)},m=function(){return r["a"].post("/config/getMenu")}},"9c5b":function(t,e,n){"use strict";n("4cd1")},c740:function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").findIndex,a=n("44d2"),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},d81d:function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").map,a=n("1dde"),o=a("map");r({target:"Array",proto:!0,forced:!o},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-8ba82336.d1917aad.js.map