(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-441fd17d"],{"58d0":function(t,e,i){"use strict";i("95f6")},"5f8a":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-date-picker",{attrs:{type:t.type,"picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:t.changeDate},model:{value:t.pickerValue,callback:function(e){t.pickerValue=e},expression:"pickerValue"}})},r=[],s=i("d4ec"),n=i("bee2"),o=i("262e"),l=i("2caf"),c=i("9ab4"),u=i("1b40"),d=function(t){Object(o["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(s["a"])(this,i),t=e.apply(this,arguments),t.pickerValue=[],t.pickerOptions={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-6048e5),t.$emit("pick",[i,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-2592e6),t.$emit("pick",[i,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-7776e6),t.$emit("pick",[i,e])}}]},t}return Object(n["a"])(i,[{key:"changeDate",value:function(){var t=this.pickerValue?this.pickerValue:this.pickerValue=["",""];this.$emit("update:start-time",t[0]),this.$emit("update:end-time",t[1])}},{key:"handleStartTime",value:function(t){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,0,t)}},{key:"handleEndTime",value:function(t){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,1,t)}}]),i}(u["e"]);Object(c["a"])([Object(u["c"])()],d.prototype,"startTime",void 0),Object(c["a"])([Object(u["c"])()],d.prototype,"endTime",void 0),Object(c["a"])([Object(u["c"])({default:"datetimerange"})],d.prototype,"type",void 0),Object(c["a"])([Object(u["f"])("startTime",{immediate:!0})],d.prototype,"handleStartTime",null),Object(c["a"])([Object(u["f"])("endTime",{immediate:!0})],d.prototype,"handleEndTime",null),d=Object(c["a"])([u["a"]],d);var m=d,f=m,p=i("2877"),b=Object(p["a"])(f,a,r,!1,null,null,null);e["a"]=b.exports},"95f6":function(t,e,i){},ade8:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-tag-edit"},[i("div",{staticClass:"ls-card"},[0==t.status?i("el-page-header",{attrs:{content:"砍价活动详情"},on:{back:function(e){return t.$router.go(-1)}}}):i("el-page-header",{attrs:{content:"add"===t.mode?"新增砍价活动":"编辑砍价活动"},on:{back:function(e){return t.$router.go(-1)}}})],1),i("el-form",{ref:"formRef",attrs:{rules:t.formRules,model:t.form,"label-width":"120px",size:"small",disabled:0==t.status}},[i("div",{staticClass:"ls-card m-t-16"},[i("div",{staticClass:"card-title"},[t._v(" 基本信息 ")]),i("div",{staticClass:"card-content m-t-24"},[i("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入活动名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"活动时间",required:""}},[i("date-picker",{attrs:{type:"datetimerange","start-time":t.form.start_time,"end-time":t.form.end_time},on:{"update:startTime":function(e){return t.$set(t.form,"start_time",e)},"update:start-time":function(e){return t.$set(t.form,"start_time",e)},"update:endTime":function(e){return t.$set(t.form,"end_time",e)},"update:end-time":function(e){return t.$set(t.form,"end_time",e)}}})],1),i("el-form-item",{attrs:{label:"标签描述",prop:"remark"}},[i("el-input",{staticClass:"ls-input-textarea",attrs:{placeholder:"请输入标签描述",type:"textarea",rows:3},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)]),i("div",{staticClass:"ls-card m-t-16"},[i("div",{staticClass:"card-title"},[t._v(" 活动商品 ")]),i("div",{staticClass:"card-content m-t-24"},[i("el-form-item",{attrs:{label:"砍价商品",prop:"",required:""}},[i("goods-select",{attrs:{mode:"table","is-spec":!0,limit:25,extend:{name:"砍价",price:[{title:"首刀价格",key:"first_knife"},{title:"底价价格",key:"floor_price"}]}},model:{value:t.selectGoods,callback:function(e){t.selectGoods=e},expression:"selectGoods"}},[i("el-button",{attrs:{size:"mini",type:"primary",disabled:2==t.status}},[t._v("选择砍价商品")])],1)],1)],1)]),i("div",{staticClass:"ls-card m-t-16"},[i("div",{staticClass:"card-title"},[t._v(" 活动规则 ")]),i("div",{staticClass:"card-content m-t-24"},[i("el-form-item",{attrs:{label:"购买方式",prop:"buy_condition"}},[i("el-radio-group",{staticClass:"m-r-16",attrs:{disabled:2==t.status},model:{value:t.form.buy_condition,callback:function(e){t.$set(t.form,"buy_condition",e)},expression:"form.buy_condition"}},[i("el-radio",{staticClass:"m-r-16",attrs:{label:1}},[t._v("砍到任意金额可购买")]),i("el-radio",{attrs:{label:2}},[t._v("砍到底价价格才可购买")])],1)],1),i("el-form-item",{attrs:{label:"砍价有效期",prop:"valid_period"}},[i("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入金额",disabled:2==t.status},model:{value:t.form.valid_period,callback:function(e){t.$set(t.form,"valid_period",e)},expression:"form.valid_period"}},[i("template",{slot:"append"},[t._v("分钟")])],2),i("div",{staticClass:"muted xs"},[t._v("用户发起砍价到砍价截止的时长，超出时间没有达到帮砍人数视为砍价失败")])],1),i("el-form-item",{attrs:{label:"帮砍人数",prop:"help_num"}},[i("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入金额",disabled:2==t.status},model:{value:t.form.help_num,callback:function(e){t.$set(t.form,"help_num",e)},expression:"form.help_num"}},[i("template",{slot:"append"},[t._v("人")])],2),i("div",{staticClass:"muted xs"},[t._v("设置帮砍人数，至少设置1人")])],1),i("el-form-item",{attrs:{label:"每刀金额",prop:"knife_amount_type",required:""}},[i("el-radio-group",{staticClass:"m-r-16",attrs:{disabled:2==t.status},model:{value:t.form.knife_amount_type,callback:function(e){t.$set(t.form,"knife_amount_type",e)},expression:"form.knife_amount_type"}},[i("el-radio",{staticClass:"m-r-16",attrs:{label:1}},[t._v("每刀固定金额")]),i("el-radio",{attrs:{label:2}},[t._v("每刀任意金额")])],1),i("div",{staticClass:"muted xs m-r-16"},[t._v(" 选择每刀固定金额时，每人砍价金额相同，达到帮砍人数才可砍至底价 ")])],1),i("el-form-item",{attrs:{label:"自己砍价",prop:"self",required:""}},[i("div",{staticClass:"flex"},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":t.styleConfig.primary,"inactive-color":"#f4f4f5",disabled:2==t.status},model:{value:t.form.self,callback:function(e){t.$set(t.form,"self",e)},expression:"form.self"}}),i("span",{staticClass:"m-l-16"},[t._v(t._s(t.form.self?"允许":"禁止"))])],1)]),i("el-form-item",{attrs:{label:"每人发起次数",prop:"count"}},[i("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入金额",disabled:2==t.status},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}},[i("template",{slot:"append"},[t._v("次")])],2),i("div",{staticClass:"muted xs"},[t._v("活动期间内，同一个活动商品允许用户发起的砍价次数")])],1),i("el-form-item",{attrs:{label:"每单限制",prop:"",required:""}},[i("div",[i("el-radio",{attrs:{label:0,disabled:2==t.status},model:{value:t.isOrderLimit,callback:function(e){t.isOrderLimit=e},expression:"isOrderLimit"}},[t._v("不限制")])],1),i("div",{staticClass:"flex"},[i("el-radio",{attrs:{label:1,disabled:2==t.status},model:{value:t.isOrderLimit,callback:function(e){t.isOrderLimit=e},expression:"isOrderLimit"}},[t._v(" 限制 ")]),i("el-input",{staticClass:"ls-input",attrs:{size:"small",disabled:2==t.status},model:{value:t.form.order_limit,callback:function(e){t.$set(t.form,"order_limit",t._n(e))},expression:"form.order_limit"}},[i("template",{slot:"append"},[t._v("件")])],2)],1),i("div",{staticClass:"muted xs"},[t._v("砍价成功后，每件商品单笔订单最多购买的件数")])])],1)])]),i("div",{staticClass:"bg-white ls-fixed-footer"},[i("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[i("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.onSubmit()}}},[t._v("保存")])],1)])],1)},r=[],s=i("5530"),n=i("d4ec"),o=i("bee2"),l=i("262e"),c=i("2caf"),u=(i("d81d"),i("9ab4")),d=i("1b40"),m=i("4201"),f=i("fac6"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"ls-dialog__trigger",on:{click:t.onTrigger}},[t._t("trigger")],2),i("el-dialog",{attrs:{"coustom-class":"ls-dialog__content",title:t.title,visible:t.visible,width:t.width,top:t.top,"modal-append-to-body":!1,center:"","before-close":t.close,"close-on-click-modal":!1,"append-to-body":!0}},[i("div",{},[i("el-form",{staticClass:"ls-form",attrs:{inline:"",model:t.form,"label-width":"70px",size:"small"}},[i("el-form-item",{attrs:{label:"商品信息"}},[i("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.getList}},[t._v("查询")]),i("el-button",{attrs:{size:"small"},on:{click:t.onReset}},[t._v("重置")])],1),i("div",{staticClass:"list-table m-t-16"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.pager.loading,expression:"pager.loading"}],staticStyle:{width:"100%"},attrs:{height:"420",data:t.pager.lists,size:"mini","header-cell-style":{background:"#f5f8ff"},"highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{prop:"",label:"商品信息","min-width":"",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"flex"},[i("el-image",{staticStyle:{width:"34px",height:"34px"},attrs:{src:e.row.image}}),i("div",{staticClass:"m-l-10"},[t._v(t._s(e.row.name))])],1)]}}])}),i("el-table-column",{attrs:{prop:"total_stock",label:"总库存","min-width":"",width:""}})],1)],1),i("div",{staticClass:"flex row-right m-t-16 row-right "},[i("ls-pagination",{on:{change:function(e){return t.getList()}},model:{value:t.pager,callback:function(e){t.pager=e},expression:"pager"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:t.close}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.onSubmit}},[t._v("确认")])],1)])],1)},b=[],v=(i("b0c0"),i("6ddb")),h=i("3c50"),g=function(t){Object(l["a"])(i,t);var e=Object(c["a"])(i);function i(){var t;return Object(n["a"])(this,i),t=e.apply(this,arguments),t.visible=!1,t.isNameSN="",t.form={name:"",category_id:""},t.pager=new v["a"],t.multipleSelection=[],t}return Object(o["a"])(i,[{key:"onTrigger",value:function(){this.getList(),this.visible=!0}},{key:"close",value:function(){this.visible=!1,this.form.name="",this.form.category_id=""}},{key:"handleSelectionChange",value:function(t){console.log(t),this.multipleSelection=t}},{key:"onReset",value:function(){this.form.name="",this.form.category_id="",this.getList()}},{key:"onSubmit",value:function(){if(!this.multipleSelection.length)return this.$message.error("请选择商品");var t=this.multipleSelection.map((function(t){return t.id}));this.$emit("getGoods",t),this.visible=!1}},{key:"getList",value:function(){this.pager.request({callback:f["f"],params:Object(s["a"])({},this.form)}).then((function(t){console.log(t)}))}}]),i}(d["e"]);Object(u["a"])([Object(d["c"])({default:""})],g.prototype,"title",void 0),Object(u["a"])([Object(d["c"])({default:"880px"})],g.prototype,"width",void 0),Object(u["a"])([Object(d["c"])({default:"10vh"})],g.prototype,"top",void 0),g=Object(u["a"])([Object(d["a"])({components:{LsPagination:h["a"]}})],g);var _=g,y=_,k=i("2877"),O=Object(k["a"])(y,p,b,!1,null,"562dad46",null),j=O.exports,C=i("5f8a"),x=i("f50c"),$=function(t){Object(l["a"])(i,t);var e=Object(c["a"])(i);function i(){var t;return Object(n["a"])(this,i),t=e.apply(this,arguments),t.mode=m["f"]["ADD"],t.identity=null,t.status=null,t.form={name:"",start_time:"",end_time:"",remark:"",is_distribution:0,buy_condition:1,valid_period:0,help_num:0,knife_amount_type:1,self:1,count:0,buy_limit:0,order_limit:0,use_coupon:0,goods:[]},t.tableData=["",""],t.goods_ids=[],t.isBuyLimit=0,t.isOrderLimit=0,t.selectGoods=[],t.formRules={name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],is_distribution:[{required:!0,message:"请选择是否参与分销",trigger:"change"}],buy_condition:[{required:!0,message:"请选择购买方式",trigger:"change"}],valid_period:[{required:!0,message:"请输入砍价有效期",trigger:"blur"}],help_num:[{required:!0,message:"请输入帮砍人数",trigger:"blur"}],count:[{required:!0,message:"请输入每人发起次数",trigger:"blur"}]},t}return Object(o["a"])(i,[{key:"isBuyLimitChange",value:function(t){0==t&&this.$set(this.form,"buy_limit",0)}},{key:"isOrderLimitChange",value:function(t){0==t&&this.$set(this.form,"order_limit",0)}},{key:"buyLimitChange",value:function(t){this.isBuyLimit=0==t?0:1}},{key:"orderLimitChange",value:function(t){this.isOrderLimit=0==t?0:1}},{key:"selectGoodsChange",value:function(t){this.form.goods=t.map((function(t){return{goods_id:t.id,items:t.item.map((function(t){return{item_id:t.id,first_knife:t.first_knife,floor_price:t.floor_price}}))}}))}},{key:"checkGoods",value:function(){var t=this.form.goods;if(!t.length)return this.$message.error("请选择砍价商品"),!1;for(var e=0;e<t.length;e++)for(var i=0;i<t[e].items.length;i++){if(!t[e].items[i].first_knife)return this.$message.error("请输入砍价商品首刀金额"),!1;if(!t[e].items[i].floor_price)return this.$message.error("请输入砍价商品底价金额"),!1}return!0}},{key:"onSubmit",value:function(){var t=this;this.$refs.formRef.validate((function(e){if(e)switch(t.mode){case m["f"]["ADD"]:return t.handleAdd();case m["f"]["EDIT"]:return t.handleEdit()}}))}},{key:"handleAdd",value:function(){var t=this;this.checkGoods(),Object(f["a"])(this.form).then((function(){setTimeout((function(){return t.$router.go(-1)}),500)})).catch((function(){}))}},{key:"handleEdit",value:function(){var t=this;this.checkGoods(),Object(f["e"])(Object(s["a"])(Object(s["a"])({},this.form),{},{id:this.identity})).then((function(){setTimeout((function(){return t.$router.go(-1)}),500)}))}},{key:"initBargainActivityDetail",value:function(){var t=this;Object(f["d"])({id:this.identity}).then((function(e){t.form=e,t.selectGoods=e.goods})).catch((function(t){console.log(t)}))}},{key:"created",value:function(){var t=this.$route.query;t.mode&&(this.mode=t.mode),this.mode===m["f"]["EDIT"]&&(this.identity=1*t.id,this.status=1*t.status,this.initBargainActivityDetail())}}]),i}(d["e"]);Object(u["a"])([Object(d["f"])("isBuyLimit",{immediate:!0})],$.prototype,"isBuyLimitChange",null),Object(u["a"])([Object(d["f"])("isOrderLimit",{immediate:!0})],$.prototype,"isOrderLimitChange",null),Object(u["a"])([Object(d["f"])("form.buy_limit",{immediate:!0})],$.prototype,"buyLimitChange",null),Object(u["a"])([Object(d["f"])("form.order_limit",{immediate:!0})],$.prototype,"orderLimitChange",null),Object(u["a"])([Object(d["f"])("selectGoods",{deep:!0})],$.prototype,"selectGoodsChange",null),$=Object(u["a"])([Object(d["a"])({components:{LsGoodsSelect:j,DatePicker:C["a"],GoodsSelect:x["a"]}})],$);var w=$,L=w,T=(i("58d0"),Object(k["a"])(L,a,r,!1,null,"ae5b026c",null));e["default"]=T.exports},c740:function(t,e,i){"use strict";var a=i("23e7"),r=i("b727").findIndex,s=i("44d2"),n="findIndex",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),a({target:"Array",proto:!0,forced:o},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),s(n)},d81d:function(t,e,i){"use strict";var a=i("23e7"),r=i("b727").map,s=i("1dde"),n=s("map");a({target:"Array",proto:!0,forced:!n},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},fac6:function(t,e,i){"use strict";i.d(e,"g",(function(){return r})),i.d(e,"c",(function(){return s})),i.d(e,"i",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"e",(function(){return l})),i.d(e,"d",(function(){return c})),i.d(e,"a",(function(){return u})),i.d(e,"f",(function(){return d})),i.d(e,"h",(function(){return m})),i.d(e,"j",(function(){return f}));var a=i("f175"),r=function(t){return a["a"].get("/bargain.bargain_activity/lists",{params:t})},s=function(t){return a["a"].post("/bargain.bargain_activity/delete",t)},n=function(t){return a["a"].post("/bargain.bargain_activity/stop",t)},o=function(t){return a["a"].post("/bargain.bargain_activity/confirm",t)},l=function(t){return a["a"].post("/bargain.bargain_activity/edit",t)},c=function(t){return a["a"].get("/bargain.bargain_activity/detail",{params:t})},u=function(t){return a["a"].post("/bargain.bargain_activity/add",t)},d=function(t){return a["a"].get("/bargain.bargain_activity/goodsLists",{params:t})},m=function(t){return a["a"].get("/bargain.bargain_activity/activityRecord",{params:t})},f=function(t){return a["a"].post("/bargain.bargain_activity/stopInitiate",t)}}}]);
//# sourceMappingURL=chunk-441fd17d.0355796d.js.map