(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8977e18a"],{"0cbf":function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"e",(function(){return a})),s.d(e,"g",(function(){return n})),s.d(e,"c",(function(){return l})),s.d(e,"h",(function(){return u})),s.d(e,"l",(function(){return c})),s.d(e,"k",(function(){return d})),s.d(e,"d",(function(){return r})),s.d(e,"f",(function(){return p})),s.d(e,"m",(function(){return _})),s.d(e,"i",(function(){return m})),s.d(e,"n",(function(){return b})),s.d(e,"j",(function(){return f})),s.d(e,"b",(function(){return g}));var o=s("f175"),i=function(t){return o["a"].post("/marketing.coupon/add",t)},a=function(t){return o["a"].post("/marketing.coupon/edit",t)},n=function(t){return o["a"].get("/marketing.coupon/lists",{params:t})},l=function(t){return o["a"].post("/marketing.coupon/delete",t)},u=function(t){return o["a"].post("/marketing.coupon/open",t)},c=function(t){return o["a"].post("/marketing.coupon/stop",t)},d=function(t){return o["a"].post("/marketing.coupon/sort",t)},r=function(t){return o["a"].get("/marketing.coupon/detail",{params:{id:t}})},p=function(t){return o["a"].get("/marketing.coupon/info",{params:{id:t}})},_=function(){return o["a"].get("/marketing.coupon/survey")},m=function(t){return o["a"].get("/marketing.coupon/record",{params:t})},b=function(t){return o["a"].post("/marketing.coupon/void",t)},f=function(t){return o["a"].post("/marketing.coupon/send",t)},g=function(t){return o["a"].get("/marketing.coupon/commonLists",{params:t})}},"34ee":function(t,e,s){"use strict";s("8f0a")},"54df":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ls-coupon-edit"},[s("div",{staticClass:"ls-card ls-coupon-edit__header"},[0==t.status?s("el-page-header",{attrs:{content:"优惠券详情"},on:{back:function(e){return t.$router.go(-1)}}}):s("el-page-header",{attrs:{content:t.id?"编辑优惠券活动":"新增优惠券活动"},on:{back:function(e){return t.$router.go(-1)}}})],1),s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("基本信息")]),s("el-form",{ref:"couponList",attrs:{rules:t.rules,model:t.couponList,"label-width":"120px",size:"small"}},[s("el-form-item",{attrs:{label:"优惠券名称",prop:"name",required:""}},[s("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,placeholder:"请输入优惠券名称"},model:{value:t.couponList.name,callback:function(e){t.$set(t.couponList,"name",e)},expression:"couponList.name"}})],1),s("el-form-item",{attrs:{label:"发放总量",prop:"send_total_type"}},[s("div",[s("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:1},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 不限制数量")])],1),s("div",{staticClass:"flex m-t-24"},[s("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:2},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 发放 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,size:"small"},model:{value:t.couponList.send_total,callback:function(e){t.$set(t.couponList,"send_total",e)},expression:"couponList.send_total"}},[s("template",{slot:"append"},[t._v("张")])],2)],1),s("span",{staticClass:"desc"},[t._v("编辑进行中的优惠券，发放总量只能增加不能减少，请谨慎设置。最多1000000张。")])]),s("el-form-item",{attrs:{label:"用券时间",prop:"send_total_type"}},[s("div",{staticClass:"m-b-24"},[s("el-radio",{attrs:{disabled:t.disabled,label:1},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v("固定日期")]),s("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"开始日期"},model:{value:t.couponList.use_time_start,callback:function(e){t.$set(t.couponList,"use_time_start",e)},expression:"couponList.use_time_start"}}),t._v(" 至 "),s("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"结束日期"},model:{value:t.couponList.use_time_end,callback:function(e){t.$set(t.couponList,"use_time_end",e)},expression:"couponList.use_time_end"}}),t._v(" 可用 ")],1),s("div",{staticClass:"flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券当日起 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time,callback:function(e){t.$set(t.couponList,"use_time",e)},expression:"couponList.use_time"}},[s("template",{slot:"append"},[t._v("天内可用")])],2)],1),s("span",{staticClass:"desc"},[t._v("至少需要填写1天")]),s("div",{staticClass:"flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券次日起 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time1,callback:function(e){t.$set(t.couponList,"use_time1",e)},expression:"couponList.use_time1"}},[s("template",{slot:"append"},[t._v("天内可用")])],2)],1),s("span",{staticClass:"desc"},[t._v("至少需要填写1天")])])],1)],1),s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("优惠设置")]),s("el-form",{ref:"couponList",attrs:{model:t.couponList,"label-width":"120px",size:"small"}},[s("el-form-item",{attrs:{label:"优惠券面额",prop:"money",required:""}},[s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled},model:{value:t.couponList.money,callback:function(e){t.$set(t.couponList,"money",e)},expression:"couponList.money"}}),s("span",{staticClass:"desc"},[t._v("面额需大于0元，支持两位小数")])],1),s("el-form-item",{attrs:{label:"使用门槛",prop:"condition_type"}},[s("div",[s("el-radio",{attrs:{disabled:t.disabled,border:"",label:1},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v("无门槛使用 ")])],1),s("div",{staticClass:"flex m-t-24"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v(" 订单满 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.condition_money,callback:function(e){t.$set(t.couponList,"condition_money",e)},expression:"couponList.condition_money"}},[s("template",{slot:"append"},[t._v("元可使用")])],2)],1),s("span",{staticClass:"desc"},[t._v("需要填写大于优惠券面额的数额")])]),s("el-form-item",{attrs:{label:"使用范围",prop:"use_goods_type"}},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("全场通用")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品可用 ")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品不可用 ")]),1!==t.couponList.use_goods_type?s("div",{staticClass:"m-t-24"},[t.disabled?t._e():s("goods-select",{attrs:{mode:"ll"},model:{value:t.goodsSelectData,callback:function(e){t.goodsSelectData=e},expression:"goodsSelectData"}},[s("el-button",{attrs:{slot:"trigger",disabled:t.disabled,size:"small",type:"primary"},slot:"trigger"},[t._v("选择商品")])],1),0!=t.goodsSelectData.length?s("el-table",{ref:"paneTable",staticClass:"m-t-24",staticStyle:{width:"100%"},attrs:{size:"small",data:t.goodsSelectData}},[s("el-table-column",{attrs:{prop:"id",label:"商品编码",width:"110"}}),s("el-table-column",{attrs:{label:"商品信息","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"flex"},[s("el-image",{staticClass:"flex-none",staticStyle:{width:"58px",height:"58px"},attrs:{src:e.row.image}}),s("div",{staticClass:"goods-info m-l-8"},[s("div",{staticClass:"line-2"},[t._v(t._s(e.row.name))])])],1)]}}],null,!1,977849216)}),s("el-table-column",{attrs:{label:"价格",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.max_price)+" ")]}}],null,!1,1062266139)}),s("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{disabled:t.disabled,type:"text",size:"small"},on:{click:function(s){return t.removeSelectGoods(e.row.id)}}},[t._v("移除")])]}}],null,!1,1973233545)})],1):t._e()],1):t._e()],1)],1)],1),s("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[s("div",{staticClass:"lg weight-500 m-b-20"},[t._v("发放设置")]),s("el-form",{ref:"couponList",attrs:{model:t.couponList,"label-width":"120px",size:"small"}},[s("el-form-item",{attrs:{label:"推广方式",prop:"get_type",required:""}},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("买家领取")]),s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("卖家发放")])],1),s("el-form-item",{attrs:{label:"领取次数",prop:"get_num_type"}},[s("el-radio-group",{model:{value:t.couponList.get_num_type,callback:function(e){t.$set(t.couponList,"get_num_type",e)},expression:"couponList.get_num_type"}},[s("div",{staticClass:"m-t-10"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:1}},[t._v("不限制领取次数")])],1),s("div",{staticClass:"m-t-24 flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:2}},[t._v(" 限制领取 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num,callback:function(e){t.$set(t.couponList,"get_num",e)},expression:"couponList.get_num"}},[s("template",{slot:"append"},[t._v("次")])],2)],1),s("div",{staticClass:"m-t-24 flex"},[s("el-radio",{attrs:{border:"",disabled:t.disabled,label:3}},[t._v(" 每天限制领取 ")]),s("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num1,callback:function(e){t.$set(t.couponList,"get_num1",e)},expression:"couponList.get_num1"}},[s("template",{slot:"append"},[t._v("次")])],2)],1)]),s("span",{staticClass:"desc"},[t._v("领取次数只对买家领取的场景有效")])],1)],1)],1),s("div",{staticClass:"ls-coupon-edit__footer bg-white ls-fixed-footer"},[s("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),s("el-button",{attrs:{size:"small",disabled:2!=t.status&&t.disabled,type:"primary"},on:{click:function(e){return t.submit("couponList")}}},[t._v("保存")])],1)])])},i=[],a=s("5530"),n=s("d4ec"),l=s("bee2"),u=s("262e"),c=s("2caf"),d=(s("99af"),s("a434"),s("d81d"),s("9ab4")),r=s("1b40"),p=s("5cf7"),_=s("f50c"),m=s("0cbf"),b=function(t){Object(u["a"])(s,t);var e=Object(c["a"])(s);function s(){var t;return Object(n["a"])(this,s),t=e.apply(this,arguments),t.disabled=!1,t.status=0,t.couponList={name:"",money:"",condition_type:1,condition_money:"",send_total_type:1,send_total:"",use_time_type:1,use_time_start:"",use_time_end:"",use_time:"",use_time1:"",get_type:1,get_num_type:1,get_num:"",get_num1:"",use_goods_type:1,use_goods_ids:[]},t.goodsSelectData=[],t.rules={name:[{required:!0,message:"请输入优惠券名称",trigger:["blur","change"]}],money:[{required:!0,message:"请输入优惠券面额",trigger:["blur","change"]}],send_total:[{required:!0,message:"请输入发放数量",trigger:["blur","change"]}]},t}return Object(l["a"])(s,[{key:"add",value:function(t){return t<10?"0"+t:t}},{key:"baseTime",value:function(t){var e=new Date(t);return"".concat(this.add(e.getFullYear()),"-").concat(this.add(e.getMonth()+1),"-").concat(this.add(e.getDate())," ").concat(this.add(e.getHours()),":").concat(this.add(e.getMinutes()),":").concat(this.add(e.getSeconds()))}},{key:"startTime",value:function(t){this.couponList.use_time_start=this.baseTime(t)}},{key:"endTime",value:function(t){this.couponList.use_time_end=this.baseTime(t)}},{key:"goodsData",value:function(t){t.length<=0||(this.goodsSelectData=t)}},{key:"removeSelectGoods",value:function(t){console.log(t);for(var e=0;e<this.goodsSelectData.length;e++)this.goodsSelectData[e].id==t&&this.goodsSelectData.splice(e,1)}},{key:"submit",value:function(t){var e=this,s=this.$refs[t];s.validate((function(t){t&&(3==e.couponList.get_num_type&&(e.couponList.get_num=e.couponList.get_num1),3==e.couponList.use_time_type&&(e.couponList.use_time=e.couponList.use_time1),1!==e.couponList.use_goods_type?e.couponList.use_goods_ids=e.goodsSelectData.map((function(t){return t.id})):e.couponList.use_goods_ids=[],e.id?e.couponEdit():e.couponAdd())}))}},{key:"couponEdit",value:function(){var t=this;Object(m["e"])(Object(a["a"])({},this.couponList)).then((function(e){setTimeout((function(){return t.$router.go(-1)}),500)}))}},{key:"couponAdd",value:function(){var t=this;Object(m["a"])(Object(a["a"])({},this.couponList)).then((function(e){setTimeout((function(){return t.$router.go(-1)}),500)}))}},{key:"getCouponDetail",value:function(){var t=this;Object(m["d"])(this.id).then((function(e){3==e.get_num_type&&(e.get_num1=e.get_num,e.get_num=""),3==e.use_time_type&&(e.use_time1=e.use_time,e.use_time=""),e.goods&&(t.goodsSelectData=e.goods),t.couponList=e}))}},{key:"created",value:function(){this.status=this.$route.query.status,this.disabled="true"==this.$route.query.disabled,this.id=this.$route.query.id,this.id&&this.getCouponDetail()}}]),s}(r["e"]);b=Object(d["a"])([Object(r["a"])({components:{AreaSelect:p["a"],GoodsSelect:_["a"]}})],b);var f=b,g=f,v=(s("34ee"),s("2877")),y=Object(v["a"])(g,o,i,!1,null,"e27f60ca",null);e["default"]=y.exports},"5cf7":function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"area-select"},[s("el-cascader",{style:{width:t.width},attrs:{options:t.options},model:{value:t.areaValue,callback:function(e){t.areaValue=e},expression:"areaValue"}})],1)},i=[],a=s("d4ec"),n=s("bee2"),l=s("262e"),u=s("2caf"),c=s("9ab4"),d=s("0463"),r=s("1b40"),p=function(t){Object(l["a"])(s,t);var e=Object(u["a"])(s);function s(){var t;return Object(a["a"])(this,s),t=e.apply(this,arguments),t.options=d["a"],t}return Object(n["a"])(s,[{key:"areaValue",get:function(){return[this.province,this.city,this.district]},set:function(t){this.$emit("update:province",t[0]),this.$emit("update:city",t[1]),this.$emit("update:district",t[2])}}]),s}(r["e"]);Object(c["a"])([Object(r["c"])()],p.prototype,"province",void 0),Object(c["a"])([Object(r["c"])()],p.prototype,"city",void 0),Object(c["a"])([Object(r["c"])()],p.prototype,"district",void 0),Object(c["a"])([Object(r["c"])({default:"380px"})],p.prototype,"width",void 0),p=Object(c["a"])([r["a"]],p);var _=p,m=_,b=s("2877"),f=Object(b["a"])(m,o,i,!1,null,null,null);e["a"]=f.exports},"8f0a":function(t,e,s){},c740:function(t,e,s){"use strict";var o=s("23e7"),i=s("b727").findIndex,a=s("44d2"),n="findIndex",l=!0;n in[]&&Array(1)[n]((function(){l=!1})),o({target:"Array",proto:!0,forced:l},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a(n)},d81d:function(t,e,s){"use strict";var o=s("23e7"),i=s("b727").map,a=s("1dde"),n=a("map");o({target:"Array",proto:!0,forced:!n},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-8977e18a.a5bb0a23.js.map