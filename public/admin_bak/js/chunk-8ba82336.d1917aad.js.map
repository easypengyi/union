{"version":3,"sources":["webpack:///./src/views/setting/permissions/role_edit.vue?0f9e","webpack:///./src/views/setting/permissions/role_edit.vue?431b","webpack:///./src/views/setting/permissions/role_edit.vue?019b","webpack:///./src/views/setting/permissions/role_edit.vue","webpack:///./src/api/setting/permissions.ts","webpack:///./src/views/setting/permissions/role_edit.vue?50fb","webpack:///./node_modules/core-js/modules/es.array.find-index.js","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","go","ref","form","rules","model","value","callback","$$v","$set","expression","minRows","maxRows","permissionsTree","children","label","handlePermissionsCheckChange","staticStyle","_v","submitForm","staticRenderFns","mode","identity","name","auth_keys","desc","required","message","trigger","data","checked","console","log","auth_key","index","findIndex","item","push","splice","formName","$refs","validate","valid","$message","error","handleRoleAdd","handleRoleEdit","params","then","setTimeout","catch","id","res","Object","keys","map","setCheckedKeys","query","$route","initFormDataForRoleEdit","getAuthMenu","component","apiAdminList","get","apiAdminDetail","apiAdminAdd","post","apiAdminDelete","apiAdminEdit","apiRoleList","apiRoleDetail","apiRoleAdd","apiRoleEdit","apiRoleDelete","apiAuthMenu","$","$findIndex","addToUnscopables","FIND_INDEX","SKIPS_HOLES","Array","target","proto","forced","callbackfn","arguments","length","undefined","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT"],"mappings":"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","file":"js/chunk-8ba82336.d1917aad.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ls-add-role\"},[_c('div',{staticClass:\"ls-card\"},[_c('el-page-header',{attrs:{\"content\":\"编辑角色\"},on:{\"back\":function($event){return _vm.$router.go(-1)}}})],1),_c('div',{staticClass:\"ls-card m-t-10\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"120px\",\"size\":\"small\"}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"required\":\"\",\"prop\":\"name\"}},[_c('el-input',{staticClass:\"ls-input\",attrs:{\"maxlength\":\"8\",\"show-word-limit\":\"\",\"placeholder\":\"请输入名称\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"描述\"}},[_c('el-input',{staticClass:\"ls-input\",attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 3, maxRows: 4 },\"placeholder\":\"请描述一下该角色\"},model:{value:(_vm.form.desc),callback:function ($$v) {_vm.$set(_vm.form, \"desc\", $$v)},expression:\"form.desc\"}})],1),_c('el-form-item',{attrs:{\"label\":\"权限\"}},[_c('el-tree',{ref:\"permissionsTree\",attrs:{\"data\":_vm.permissionsTree,\"node-key\":\"auth_key\",\"default-expand-all\":\"\",\"icon-class\":\"el-icon-arrow-right\",\"props\":{\n                        children: 'sons',\n                        label: 'name'\n                    },\"empty-text\":\"\",\"show-checkbox\":\"\"},on:{\"check-change\":_vm.handlePermissionsCheckChange}})],1)],1)],1),_c('div',{staticClass:\"bg-white ls-fixed-footer\"},[_c('div',{staticClass:\"row-center flex\",staticStyle:{\"height\":\"100%\"}},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('form')}}},[_vm._v(\"保存\")])],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator'\nimport {\n    apiRoleAdd,\n    apiRoleEdit,\n    apiRoleDetail,\n    apiAuthMenu,\n} from '@/api/setting/permissions'\nimport { RoleAdd_Req } from '@/api/setting/permissions.d'\nimport { PageMode } from '@/utils/type'\n\n@Component\nexport default class RoleEdit extends Vue {\n    /** S Data **/\n    mode: string = PageMode['ADD'] // 当前页面【add: 添加角色 | edit: 编辑角色】\n    identity: number | null = null // 当前编辑用户的身份ID  valid: mode = 'edit'\n\n    // 表单数据\n    form: RoleAdd_Req = {\n        name: '',\n        auth_keys: [],\n        desc: '',\n    }\n\n    // 权限树\n    permissionsTree: object[] = []\n\n    // 表单验证\n    rules: object = {\n        name: [{ required: true, message: '必填项不可为空', trigger: 'blur' }],\n    }\n\n    /** E Data **/\n\n    /** S Methods **/\n    handlePermissionsCheckChange(data: any, checked: boolean) {\n        console.log(data)\n        if (!data.auth_key) {\n            return\n        }\n        let index = this.form.auth_keys.findIndex(\n            (item) => item == data.auth_key\n        )\n        if (checked) {\n            index == -1 && this.form.auth_keys.push(data.auth_key)\n            return\n        }\n       \n        if (index != -1) {\n            this.form.auth_keys.splice(index, 1)\n        }\n    }\n\n    // 表单提交\n    submitForm(formName: string) {\n        const ref = this.$refs[formName] as HTMLFormElement\n        ref.validate((valid: boolean) => {\n            if (!valid) return this.$message.error('请完善信息')\n\n            // 请求发送\n            switch (this.mode) {\n                case PageMode['ADD']:\n                    return this.handleRoleAdd()\n                case PageMode['EDIT']:\n                    return this.handleRoleEdit()\n            }\n        })\n    }\n\n    // 添加角色\n    handleRoleAdd() {\n        const params = this.form\n        apiRoleAdd(params)\n            .then(() => {\n                setTimeout(() => this.$router.go(-1), 500)\n            })\n            .catch(() => {\n            })\n    }\n\n    // 编辑角色\n    handleRoleEdit() {\n        const params = this.form\n        const id: number = this.identity as number\n        apiRoleEdit({ ...params, id })\n            .then(() => {\n                setTimeout(() => this.$router.go(-1), 500)\n            })\n            .catch(() => {\n                \n            })\n    }\n\n    // 初始化表单数据: 角色编辑\n    initFormDataForRoleEdit() {\n        const id: number = this.identity as number\n        apiRoleDetail({ id })\n            .then((res) => {\n                Object.keys(res).map((item) => {\n                    this.$set(this.form, item, res[item])\n                })\n                this.form.auth_keys = []\n                const ref = this.$refs['permissionsTree'] as any\n                ref.setCheckedKeys(res.auth_keys);\n            })\n            .catch(() => {\n            })\n    }\n\n    // 获取权限菜单\n    getAuthMenu() {\n        apiAuthMenu().then((res) => {\n            this.permissionsTree = res\n        })\n    }\n\n    /** E Methods **/\n\n    /** S Life Cycle **/\n    created() {\n        const query: any = this.$route.query\n        if (query.mode) this.mode = query.mode\n\n        if (this.mode === PageMode['EDIT']) {\n            this.identity = query.id * 1\n            this.initFormDataForRoleEdit()\n        }\n        this.getAuthMenu()\n    }\n\n    /** S Life Cycle **/\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./role_edit.vue?vue&type=template&id=d898fef8&scoped=true&\"\nimport script from \"./role_edit.vue?vue&type=script&lang=ts&\"\nexport * from \"./role_edit.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./role_edit.vue?vue&type=style&index=0&id=d898fef8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d898fef8\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/plugins/axios'\nimport * as Interface from '@/api/setting/permissions.d'\n\n\n/** S 管理员 **/\n// 管理员列表 \nexport const apiAdminList = (params: Interface.AdminList_Req): Promise<Interface.AdminList_Res> =>\n    request.get('/auth.admin/lists', { params })\n\n// 管理员详情\nexport const apiAdminDetail = (params: Interface.AdminDetail_Req): Promise<Interface.AdminDetail_Res> =>\n    request.get('/auth.admin/detail', { params })\n\n// 添加管理员\nexport const apiAdminAdd = (data: Interface.AdminAdd_Req): Promise<any> =>\n    request.post('/auth.admin/add', data)\n\n// 删除管理员\nexport const apiAdminDelete = (data: Interface.AdminDelete_Req): Promise<any> =>\n    request.post('/auth.admin/delete', data)\n\n// 编辑管理员\nexport const apiAdminEdit = (data: Interface.AdminEdit_Req): Promise<any> =>\n    request.post('/auth.admin/edit', data)\n\n/** E 管理员 **/\n\n\n\n/** S 角色 **/\n// 角色列表\nexport const apiRoleList = (params?: Interface.RoleList_Req): Promise<Interface.RoleList_Res> =>\n    request.get('/auth.role/lists', { params })\n\n// 角色详情\nexport const apiRoleDetail = (params: Interface.RoleDetail_Req): Promise<Interface.RoleDetail_Res> =>\n    request.get('/auth.role/detail', { params })\n\n// 添加角色\nexport const apiRoleAdd = (data: Interface.RoleAdd_Req): Promise<any> =>\n    request.post('/auth.role/add', data)\n\n// 编辑角色\nexport const apiRoleEdit = (data: Interface.RoleEdit_Req): Promise<any> =>\n    request.post('/auth.role/edit', data)\n\n// 删除角色\nexport const apiRoleDelete = (data: Interface.RoleDelete_Req): Promise<any> =>\n    request.post('/auth.role/delete', data)\n\n// 权限菜单\nexport const apiAuthMenu = () => request.post('/config/getMenu')\n/** E 角色 **/","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=style&index=0&id=d898fef8&lang=scss&scoped=true&\"","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}