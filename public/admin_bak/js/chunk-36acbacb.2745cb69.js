(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36acbacb"],{"20b4":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"system-update"},[i("div",{staticClass:"ls-card"},[i("el-alert",{staticClass:"xxl",attrs:{type:"info",closable:!1,"show-icon":""}},[i("template",{slot:"title"},[i("div",{staticClass:"iconSize"},[t._v("温馨提示：")]),i("div",{staticClass:"iconSize flex"},[t._v("1.版本更新需要逐个版本更新，"),i("div",{staticClass:"a-key"},[t._v("更新前请备份好系统和数据库，更新成功后需要强制刷新站点；")])]),i("div",{staticClass:"iconSize"},[t._v("2.系统没有做二次开发，可以直接选择在线更新功能；")]),i("div",{staticClass:"iconSize"},[t._v("3.系统已做二次开发，进行了功能修改，请谨慎选择在线更新功能，推荐以更新包的形式手动更新；")]),i("div",{staticClass:"iconSize"},[t._v("4.由于更换新域名原因，1.3.1及以下版本，需修改server/app/adminapi/logic/settings/system/UpgradeLogic.php文件中的BASE_URL为https://server.likeshop.cn 否则系统更新列表会报错。")])])],2)],1),i("div",{staticClass:"ls-card m-t-16"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticStyle:{width:"100%"},attrs:{data:t.pager.lists,size:"mini","header-cell-style":{background:"#f5f8ff"}}},[i("el-table-column",{attrs:{prop:"publish_time",label:"发布日期"}}),i("el-table-column",{attrs:{label:"版本号"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"flex"},[0==e.$index?i("el-tag",{attrs:{size:"small",type:"success",effect:"plain",round:""}},[t._v(" new")]):t._e(),i("div",{staticClass:"m-l-5"},[t._v(t._s(e.row.version_no))])],1),i("div",{},[t._v(" "+t._s(e.row.version_str)+" ")])]}}])}),i("el-table-column",{attrs:{prop:"",label:"版本内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.add,(function(e,n){return i("div",{},[t._v(" "+t._s(e)+" ")])})),t._l(e.row.optimize,(function(e,n){return i("div",{},[t._v(" "+t._s(e)+" ")])})),t._l(e.row.repair,(function(e,n){return i("div",{},[t._v(" "+t._s(e)+" ")])}))]}}])}),i("el-table-column",{attrs:{prop:"notice",label:"注意事项"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.notice,(function(e,n){return i("div",{key:n},[t._v(" "+t._s(e)+" ")])}))}}])}),i("el-table-column",{attrs:{label:"操作","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"operation flex flex-wrap"},[1==e.row.able_update?i("el-button",{staticClass:"m-r-10",attrs:{slot:"trigger",type:"primary",size:"small"},on:{click:function(i){return t.onOuterVisible(e.row.id)}},slot:"trigger"},[t._v("一键更新 ")]):t._e(),e.row.integral_package_link?i("el-button",{staticClass:"m-r-10",attrs:{slot:"trigger",type:"",size:"small"},on:{click:function(i){return t.toPackage(e.row.id,6)}},slot:"trigger"},[t._v("下载完整安装包 ")]):t._e(),e.row.package_link?i("el-button",{staticClass:"m-r-10",attrs:{slot:"trigger",type:"",size:"small"},on:{click:function(i){return t.toPackage(e.row.id,2)}},slot:"trigger"},[t._v("下载服务端更新包")]):t._e(),e.row.pc_package_link?i("el-button",{staticClass:"m-r-10",attrs:{slot:"trigger",type:"",size:"small"},on:{click:function(i){return t.toPackage(e.row.id,3)}},slot:"trigger"},[t._v("下载pc端更新包")]):t._e(),e.row.uniapp_package_link?i("el-button",{staticClass:"m-r-10",attrs:{slot:"trigger",type:"",size:"small"},on:{click:function(i){return t.toPackage(e.row.id,4)}},slot:"trigger"},[t._v("下载uniapp更新包")]):t._e(),e.row.web_package_link?i("el-button",{attrs:{slot:"trigger",type:"",size:"small"},on:{click:function(i){return t.toPackage(e.row.id,5)}},slot:"trigger"},[t._v(" 下载后台前端更新包")]):t._e()],1)]}}])})],1)],1),i("el-dialog",{staticClass:"dialog",attrs:{title:"",visible:t.outerVisible,width:"30%",top:"40vh",center:""},on:{"update:visible":function(e){t.outerVisible=e}}},[i("el-dialog",{staticClass:"dialogTwo",attrs:{width:"30%",top:"40vh",visible:t.innerVisible,"append-to-body":"",center:""},on:{"update:visible":function(e){t.innerVisible=e}}},[i("el-dialog",{staticClass:"dialogThree",attrs:{width:"30%",top:"40vh",visible:t.threeVisible,"append-to-body":"",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.threeVisible=e}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{height:"200px","text-align":"center"},attrs:{"element-loading-text":"切勿关闭窗口或刷新页面"}},[i("div",[t._v("系统更新中，更新完毕后会自行刷新页面")])])]),0==t.isSecondaryDev?i("div",{staticStyle:{height:"200px"}},[i("div",{staticStyle:{"text-align":"center"}},[t._v(" 一键更新导致的系统问题，欢迎前往社区反馈，请做好系统备份！ ")]),i("div",{staticClass:"btn-div flex-col ",staticStyle:{width:"160px",margin:"auto"}},[i("el-button",{staticStyle:{"margin-top":"15px","margin-left":"0"},attrs:{type:"primary",size:"small"},on:{click:t.confirmUpdate}},[t._v("确定更新")]),i("el-button",{staticStyle:{"margin-top":"15px","margin-left":"0"},attrs:{size:"small"},on:{click:function(e){t.innerVisible=!1}}},[t._v(" 取消更新")])],1)]):t._e(),1==t.isSecondaryDev?i("div",{staticStyle:{height:"200px"}},[i("div",{staticStyle:{"text-align":"center"}},[i("div",[t._v("二次开发后请谨慎使用一键更新功能！")]),i("div",[t._v("二次开发后一键更新导致的系统问题，官方无法处理，请做好系统备份！")])]),i("div",{staticClass:"btn-div flex-col",staticStyle:{width:"160px",margin:"auto"}},[i("el-button",{staticStyle:{"margin-top":"15px","margin-left":"0"},attrs:{type:"primary",size:"small"},on:{click:t.confirmUpdate}},[t._v("确定更新")]),i("el-button",{staticStyle:{"margin-top":"15px","margin-left":"0"},attrs:{size:"small"},on:{click:function(e){t.innerVisible=!1}}},[t._v(" 下载更新包，手动更新")]),i("el-button",{staticStyle:{"margin-top":"15px","margin-left":"0"},attrs:{size:"small"},on:{click:function(e){t.innerVisible=!1}}},[t._v(" 取消更新")])],1)]):t._e()],1),i("div",{staticStyle:{height:"200px"}},[i("div",{staticStyle:{"text-align":"center"}},[t._v(" 系统是否进行二次开发 ")]),i("div",{staticClass:"flex-col"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.NotSecondaryDev}},[t._v("未做二次开发，直接更新")]),i("el-button",{attrs:{size:"small"},on:{click:t.SecondaryDev}},[t._v("已做二次开发")]),i("el-button",{attrs:{size:"small"},on:{click:function(e){t.outerVisible=!1}}},[t._v("取消更新")])],1)])],1)],1)},a=[],s=i("d4ec"),r=i("bee2"),l=i("262e"),o=i("2caf"),c=(i("d3b7"),i("9ab4")),u=i("1b40"),d=i("469e"),p=i("6ddb"),v=i("3c50"),g=function(t){Object(l["a"])(i,t);var e=Object(o["a"])(i);function i(){var t;return Object(s["a"])(this,i),t=e.apply(this,arguments),t.outerVisible=!1,t.innerVisible=!1,t.threeVisible=!1,t.isSecondaryDev=!0,t.loading=!0,t.pager=new p["a"],t.id=0,t.timer=0,t}return Object(r["a"])(i,[{key:"getSystemUpgradeLists",value:function(){var t=this;this.pager.request({callback:d["k"]}).catch((function(){t.$message.error("数据请求失败，刷新重载")}))}},{key:"toPackage",value:function(t,e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){Object(d["j"])({id:t,update_type:e}).then((function(t){6==e?window.open(t.line,"_blank"):window.location.href=t.line}))}),500)}},{key:"systemUpgrade",value:function(){var t=this;Object(d["i"])({id:this.id,update_type:1}).then((function(e){t.getSystemUpgradeLists()})).finally((function(){t.threeVisible=!1,t.innerVisible=!1,t.outerVisible=!1}))}},{key:"onOuterVisible",value:function(t){this.outerVisible=!0,this.id=t}},{key:"NotSecondaryDev",value:function(){this.isSecondaryDev=!1,this.innerVisible=!0}},{key:"SecondaryDev",value:function(){this.isSecondaryDev=!0,this.innerVisible=!0}},{key:"confirmUpdate",value:function(){this.threeVisible=!0,this.systemUpgrade()}},{key:"created",value:function(){this.getSystemUpgradeLists()}}]),i}(u["e"]);g=Object(c["a"])([Object(u["a"])({components:{LsPagination:v["a"]}})],g);var f=g,b=f,m=(i("d2d1"),i("2877")),_=Object(m["a"])(b,n,a,!1,null,"3d3d558c",null);e["default"]=_.exports},"469e":function(t,e,i){"use strict";i.d(e,"l",(function(){return a})),i.d(e,"h",(function(){return s})),i.d(e,"f",(function(){return r})),i.d(e,"a",(function(){return l})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return c})),i.d(e,"b",(function(){return u})),i.d(e,"e",(function(){return d})),i.d(e,"g",(function(){return p})),i.d(e,"k",(function(){return v})),i.d(e,"j",(function(){return g})),i.d(e,"i",(function(){return f}));var n=i("f175"),a=function(t){return n["a"].get("/settings.system.log/lists",{params:t})},s=function(){return n["a"].post("/settings.system.cache/clear")},r=function(){return n["a"].get("/crontab.crontab/lists")},l=function(t){return n["a"].post("/crontab.crontab/add",t)},o=function(t){return n["a"].get("/crontab.crontab/detail",{params:t})},c=function(t){return n["a"].post("/crontab.crontab/edit",t)},u=function(t){return n["a"].post("/crontab.crontab/delete",t)},d=function(t){return n["a"].get("/crontab.crontab/expression",{params:t})},p=function(t){return n["a"].post("/crontab.crontab/operate",t)},v=function(t){return n["a"].get("/settings.system.upgrade/lists")},g=function(t){return n["a"].post("/settings.system.upgrade/downloadPkg",t)},f=function(t){return n["a"].post("/settings.system.upgrade/upgrade",t)}},d2d1:function(t,e,i){"use strict";i("d783")},d783:function(t,e,i){}}]);
//# sourceMappingURL=chunk-36acbacb.2745cb69.js.map