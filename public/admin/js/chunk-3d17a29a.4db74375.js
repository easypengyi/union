(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d17a29a"],{"0bb6":function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return n})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return d}));var a=i("f175");const s=e=>a["a"].post("/marketing.seckill/add",e),l=e=>a["a"].post("/marketing.seckill/edit",e),r=e=>a["a"].get("/marketing.seckill/detail",{params:e}),o=e=>a["a"].get("/marketing.seckill/lists",{params:e}),n=e=>a["a"].post("/marketing.seckill/delete",e),c=e=>a["a"].post("/marketing.seckill/open",{params:e}),d=e=>a["a"].post("/marketing.seckill/stop",{params:e})},"1ae8":function(e,t,i){},"239d":function(e,t,i){},"5f8a":function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-date-picker",{attrs:{type:e.type,"picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.changeDate},model:{value:e.pickerValue,callback:function(t){e.pickerValue=t},expression:"pickerValue"}})},s=[],l=i("9ab4"),r=i("1b40");let o=class extends r["e"]{constructor(){super(...arguments),this.pickerValue=[],this.pickerOptions={shortcuts:[{text:"最近一周",onClick(e){const t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick(e){const t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick(e){const t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]}}changeDate(){const e=this.pickerValue?this.pickerValue:this.pickerValue=["",""];this.$emit("update:start-time",e[0]),this.$emit("update:end-time",e[1])}handleStartTime(e){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,0,e)}handleEndTime(e){!this.pickerValue&&(this.pickerValue=[]),this.$set(this.pickerValue,1,e)}};Object(l["a"])([Object(r["c"])()],o.prototype,"startTime",void 0),Object(l["a"])([Object(r["c"])()],o.prototype,"endTime",void 0),Object(l["a"])([Object(r["c"])({default:"datetimerange"})],o.prototype,"type",void 0),Object(l["a"])([Object(r["f"])("startTime",{immediate:!0})],o.prototype,"handleStartTime",null),Object(l["a"])([Object(r["f"])("endTime",{immediate:!0})],o.prototype,"handleEndTime",null),o=Object(l["a"])([r["a"]],o);var n=o,c=n,d=i("2877"),m=Object(d["a"])(c,a,s,!1,null,null,null);t["a"]=m.exports},"8f04":function(e,t,i){"use strict";i("1ae8")},b3ad:function(e,t,i){"use strict";var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("ls-dialog",{ref:"materialDialog",staticClass:"material-select",attrs:{title:"选择"+e.tipsText,width:"1050px",top:"15vh"},on:{confirm:e.handleConfirm}},[e.hiddenTrigger?e._e():t("div",{staticClass:"material-select__trigger clearfix",attrs:{slot:"trigger"},on:{click:function(e){e.stopPropagation()}},slot:"trigger"},[t("draggable",{staticClass:"ls-draggable",attrs:{animation:"300",disabled:e.disabled||e.dragDisabled},on:{update:e.handleChange},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},e._l(e.fileList,(function(i,a){return t("div",{key:i+a,staticClass:"material-preview ls-del-wrap",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!1,a)}}},[e.$scopedSlots.preview?t("div",[e._t("preview",null,{item:e.imageUri(i)})],2):t("file-item",{attrs:{type:e.type,item:{uri:e.imageUri(i)},size:e.size}}),e.enableDelete?t("i",{staticClass:"el-icon-close ls-icon-del",on:{click:function(t){return t.stopPropagation(),e.delImage(a)}}}):e._e()],1)})),0),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpload,expression:"showUpload"}],staticClass:"material-upload",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!0)}}},[e.$slots.upload?t("div",[e._t("upload")],2):t("div",{staticClass:"upload-btn flex row-center",style:{width:e.size+"px",height:e.size+"px",background:e.uploadBg}},[e._t("default"),e.$slots.default?e._e():t("span",[e._v("添加"+e._s(e.tipsText))])],2)])],1),t("div",{staticClass:"material-wrap"},[t("ls-material",{ref:"material",attrs:{"page-size":15,type:e.type,limit:e.meterialLimit},on:{change:e.selectChange}})],1)])},s=[],l=i("9ab4"),r=i("1b40"),o=i("0a6d"),n=i("c6fe"),c=i("e915"),d=i("b76a"),m=i.n(d);let u=class extends r["e"]{constructor(){super(...arguments),this.isAdd=!0,this.fileList=[]}get showUpload(){const{fileList:e,limit:t}=this;return t-e.length>0}get meterialLimit(){return this.isAdd?this.limit?this.limit-this.fileList.length:null:1}get tipsText(){switch(this.type){case"image":return"图片";case"video":return"视频"}}get imageUri(){return e=>this.enableDomain?e:this.$getImageUri(e)}valueChange(e){this.fileList=Array.isArray(e)?e:""==e?[]:[e]}showDialog(e=!0,t){var i;this.disabled||(this.isAdd=e,void 0!==t&&(this.currentIndex=t),null===(i=this.$refs.materialDialog)||void 0===i||i.onTrigger())}selectChange(e){this.select=e}handleConfirm(){this.$refs.material.clearSelectList();const e=this.select.map(e=>this.enableDomain?e.uri:e.url);this.isAdd?this.fileList=this.fileList.concat(e):this.fileList.splice(this.currentIndex,1,e.shift()),this.handleChange()}delImage(e){this.fileList.splice(e,1),this.handleChange()}handleChange(){const e=1!=this.limit?this.fileList:this.fileList[0]||"";this.$emit("input",e),this.$emit("change",e),this.fileList=[]}};Object(l["a"])([Object(r["c"])({default:()=>[]})],u.prototype,"value",void 0),Object(l["a"])([Object(r["c"])({default:1})],u.prototype,"limit",void 0),Object(l["a"])([Object(r["c"])({default:"100"})],u.prototype,"size",void 0),Object(l["a"])([Object(r["c"])({default:!1})],u.prototype,"disabled",void 0),Object(l["a"])([Object(r["c"])({default:!1})],u.prototype,"dragDisabled",void 0),Object(l["a"])([Object(r["c"])({default:!1})],u.prototype,"hiddenTrigger",void 0),Object(l["a"])([Object(r["c"])({default:"image"})],u.prototype,"type",void 0),Object(l["a"])([Object(r["c"])({default:"transparent"})],u.prototype,"uploadBg",void 0),Object(l["a"])([Object(r["c"])({default:!0})],u.prototype,"enableDomain",void 0),Object(l["a"])([Object(r["c"])({default:!0})],u.prototype,"enableDelete",void 0),Object(l["a"])([Object(r["f"])("value",{immediate:!0})],u.prototype,"valueChange",null),u=Object(l["a"])([Object(r["a"])({components:{LsDialog:o["a"],LsMaterial:n["a"],Draggable:m.a,FileItem:c["a"]}})],u);var p=u,f=p,h=(i("fb48"),i("2877")),b=Object(h["a"])(f,a,s,!1,null,"1503bff6",null);t["a"]=b.exports},c1f0:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"ls-seckill-edit"},[t("div",{staticClass:"ls-card ls-seckill-edit__header"},[t("el-page-header",{attrs:{content:e.id?e.disabled?"秒杀活动详情":"编辑秒杀活动":"新增秒杀活动"},on:{back:function(t){return e.$router.go(-1)}}})],1),t("div",{staticClass:"ls-seckill-content"},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.formData,"label-width":"120px",size:"small",rules:e.rules,disabled:e.disabled}},[t("div",{staticClass:"ls-card m-t-16"},[t("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动设置")]),t("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[t("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入活动名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),t("el-form-item",{attrs:{label:"活动时间",prop:"start_time"}},[t("date-picker",{attrs:{type:"datetimerange","start-time":e.formData.start_time,"end-time":e.formData.end_time},on:{"update:startTime":function(t){return e.$set(e.formData,"start_time",t)},"update:start-time":function(t){return e.$set(e.formData,"start_time",t)},"update:endTime":function(t){return e.$set(e.formData,"end_time",t)},"update:end-time":function(t){return e.$set(e.formData,"end_time",t)}}}),t("div",{staticClass:"muted"},[e._v(" 秒杀活动开始和结束时间，可以手动提前结束活动 ")])],1),t("el-form-item",{attrs:{label:"活动备注"}},[t("el-input",{staticClass:"ls-input",attrs:{type:"textarea",rows:5,placeholder:""},model:{value:e.formData.explain,callback:function(t){e.$set(e.formData,"explain",t)},expression:"formData.explain"}})],1)],1),t("div",{staticClass:"ls-card m-t-16"},[t("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动商品")]),t("el-form-item",{attrs:{label:"秒杀商品",required:""}},[t("goods-select",{attrs:{mode:"table","is-spec":!0,limit:25,extend:{name:"秒杀",price:[{title:"秒杀价格",key:"seckill_price"}]}},model:{value:e.selectGoods,callback:function(t){e.selectGoods=t},expression:"selectGoods"}},[t("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("选择秒杀商品")])],1)],1)],1),t("div",{staticClass:"ls-card m-t-16"},[t("div",{staticClass:"nr weight-500 m-b-20"},[e._v("活动规则")]),t("el-form-item",{attrs:{label:"每单限制",required:""}},[t("el-radio-group",{model:{value:e.formData.max_buy,callback:function(t){e.$set(e.formData,"max_buy",t)},expression:"formData.max_buy"}},[t("el-radio",{attrs:{label:0}},[e._v("不限制")]),t("el-radio",{attrs:{label:0!=e.formData.max_buy?e.formData.max_buy:""}},[e._v("限制")])],1)],1),0!==e.formData.max_buy?t("el-form-item",{attrs:{prop:"max_buy",label:""}},[t("el-input",{attrs:{type:"number"},on:{input:function(t){return e.handleInput(t,"max_buy")}},model:{value:e.formData.max_buy,callback:function(t){e.$set(e.formData,"max_buy",t)},expression:"formData.max_buy"}}),t("div",{staticClass:"muted"},[e._v(" 每件商品单笔订单最多购买的件数。 ")])],1):e._e()],1)])],1),t("div",{staticClass:"ls-seckill-edit__footer bg-white ls-fixed-footer"},[t("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary",disabled:e.disabled},on:{click:e.handleSave}},[e._v("保存")])],1)])])},s=[],l=i("9ab4"),r=i("1b40"),o=i("b3ad"),n=i("f50c"),c=i("5f8a"),d=i("0bb6");let m=class extends r["e"]{constructor(){super(...arguments),this.loading=!1,this.disabled=!1,this.formData={name:"",explain:"",start_time:"",end_time:"",goods:[],max_buy:0},this.selectGoods=[],this.rules={name:[{required:!0,message:"请输入活动名称",trigger:["blur"]}],start_time:[{required:!0,message:"选择活动时间",trigger:"blur"}],max_buy:[{required:!0,message:"请输入每单限制数量",trigger:"blur"}]}}selectGoodsChange(e){this.formData.goods=e.map(e=>({goods_id:e.id,items:e.item.map(e=>({item_id:e.id,seckill_price:e.seckill_price}))}))}checkGoods(){let e=this.formData.goods;if(!e.length)return this.$message.error("请选择秒杀商品"),!1;for(let t=0;t<e.length;t++)for(let i=0;i<e[t].items.length;i++)if(!e[t].items[i].seckill_price)return this.$message.error("请输入商品秒杀价"),!1;return!0}handleInput(e,t){e<=0&&""!==e&&(this.formData[t]=1)}handleSave(){this.$refs.form.validate((e,t)=>{if(!e)return!1;{if(!this.checkGoods())return;const e=this.id?Object(d["d"])(this.formData):Object(d["a"])(this.formData);e.then(()=>{this.$router.go(-1)})}})}getDetail(){this.loading=!0,Object(d["c"])({id:this.id}).then(e=>{this.formData=e,this.selectGoods=e.goods,this.loading=!1})}created(){this.id=this.$route.query.id,this.disabled=Boolean(this.$route.query.disabled),this.id&&this.getDetail()}};Object(l["a"])([Object(r["f"])("selectGoods",{deep:!0})],m.prototype,"selectGoodsChange",null),m=Object(l["a"])([Object(r["a"])({components:{MaterialSelect:o["a"],DatePicker:c["a"],GoodsSelect:n["a"]}})],m);var u=m,p=u,f=(i("8f04"),i("2877")),h=Object(f["a"])(p,a,s,!1,null,"3aa927c1",null);t["default"]=h.exports},fb48:function(e,t,i){"use strict";i("239d")}}]);
//# sourceMappingURL=chunk-3d17a29a.4db74375.js.map