(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a24cb00"],{"00df":function(t,e,s){},"469e":function(t,e,s){"use strict";s.d(e,"l",(function(){return a})),s.d(e,"h",(function(){return o})),s.d(e,"f",(function(){return i})),s.d(e,"a",(function(){return n})),s.d(e,"c",(function(){return l})),s.d(e,"d",(function(){return c})),s.d(e,"b",(function(){return m})),s.d(e,"e",(function(){return u})),s.d(e,"g",(function(){return d})),s.d(e,"k",(function(){return f})),s.d(e,"j",(function(){return p})),s.d(e,"i",(function(){return h}));var r=s("f175");const a=t=>r["a"].get("/settings.system.log/lists",{params:t}),o=()=>r["a"].post("/settings.system.cache/clear"),i=()=>r["a"].get("/crontab.crontab/lists"),n=t=>r["a"].post("/crontab.crontab/add",t),l=t=>r["a"].get("/crontab.crontab/detail",{params:t}),c=t=>r["a"].post("/crontab.crontab/edit",t),m=t=>r["a"].post("/crontab.crontab/delete",t),u=t=>r["a"].get("/crontab.crontab/expression",{params:t}),d=t=>r["a"].post("/crontab.crontab/operate",t),f=t=>r["a"].get("/settings.system.upgrade/lists"),p=t=>r["a"].post("/settings.system.upgrade/downloadPkg",t),h=t=>r["a"].post("/settings.system.upgrade/upgrade",t)},dfae:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"substance_edit-help"},[e("div",{staticClass:"ls-card"},[e("el-page-header",{attrs:{content:"add"==this.mode?"新增定时任务":"编辑定时任务"},on:{back:function(e){return t.$router.go(-1)}}})],1),e("div",{staticClass:"ls-card m-t-16 form-container"},[e("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"120px",size:"small"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{staticClass:"ls-input",attrs:{"show-word-limit":"",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"类型"}},[e("el-radio",{attrs:{label:1},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[t._v("定时任务")])],1),e("el-form-item",{attrs:{label:"命令",prop:"command"}},[e("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入thankphp命令，如vresion"},model:{value:t.form.command,callback:function(e){t.$set(t.form,"command",e)},expression:"form.command"}})],1),e("el-form-item",{attrs:{label:"参数"}},[e("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入参数，例:--id 8 --name 测试"},model:{value:t.form.params,callback:function(e){t.$set(t.form,"params",e)},expression:"form.params"}})],1),e("el-form-item",{attrs:{label:"状态"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":t.styleConfig.primary,"inactive-color":"#f4f4f5"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("el-form-item",{attrs:{label:"规则",prop:"expression"}},[e("el-input",{staticClass:"ls-input",attrs:{placeholder:"请输入crontab规则，例：59 * * *"},on:{blur:t.blur},model:{value:t.form.expression,callback:function(e){t.$set(t.form,"expression",e)},expression:"form.expression"}}),e("el-table",{ref:"paneTable",staticClass:"m-t-24",staticStyle:{width:"100%"},attrs:{data:t.lists,size:"mini"}},[e("el-table-column",{attrs:{prop:"time",label:"序号","min-width":"80"}}),e("el-table-column",{attrs:{prop:"date",label:"执行时间","min-width":"180"}})],1)],1),e("el-form-item",{attrs:{label:"备注"}},[e("el-input",{staticClass:"ls-input",attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1),e("div",{staticClass:"bg-white ls-fixed-footer"},[e("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("保存")])],1)])])},a=[],o=s("9ab4"),i=s("1b40"),n=s("469e"),l=s("4201");let c=class extends i["e"]{constructor(){super(...arguments),this.mode=l["f"]["ADD"],this.lists=[],this.form={name:"",type:1,command:"",expression:"",status:1,remark:"",params:""},this.rules={name:[{required:!0,message:"请输入名称",trigger:"blur"}],command:[{required:!0,message:"请输入命令",trigger:"blur"}],params:[{required:!0,message:"请输入参数",trigger:"blur"}],expression:[{required:!0,message:"请输入规则",trigger:"blur"}]}}onSubmit(t){const e=this.$refs[t];e.validate(t=>{if(t)switch(this.mode){case l["f"]["ADD"]:return this.handleNoticeAdd();case l["f"]["EDIT"]:return this.handleNoticeEdit()}})}blur(){""!=this.form.expression&&this.getExpressionFun()}getExpressionFun(){Object(n["e"])({expression:this.form.expression}).then(t=>{console.log(t),this.lists=t})}handleNoticeAdd(){const t=this.form;console.log(t),Object(n["a"])(t).then(()=>{setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{this.$message.error("添加失败!")})}handleNoticeEdit(){delete this.form.status_desc,delete this.form.type_desc;const t=this.form;Object(n["d"])(t).then(()=>{setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{this.$message.error("修改失败!")})}initFormDataForNoticeEdit(){Object(n["c"])({id:this.form.id}).then(t=>{Object.keys(t).map(e=>{this.$set(this.form,e,t[e])}),this.getExpressionFun()}).catch(()=>{this.$message.error("数据初始化失败，请刷新重载！")})}created(){const t=this.$route.query;t.mode&&(this.mode=t.mode),this.mode===l["f"]["EDIT"]&&(this.form.id=1*t.id,this.initFormDataForNoticeEdit())}};c=Object(o["a"])([i["a"]],c);var m=c,u=m,d=(s("fcd7"),s("2877")),f=Object(d["a"])(u,r,a,!1,null,"44c8c8ee",null);e["default"]=f.exports},fcd7:function(t,e,s){"use strict";s("00df")}}]);
//# sourceMappingURL=chunk-3a24cb00.eeaa545a.js.map