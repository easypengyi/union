(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5437e4e5"],{"1abe":function(e,t,s){"use strict";s("60a1")},"239d":function(e,t,s){},"3a4f":function(e,t,s){"use strict";s("ab28")},"40df":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"live-broadcast-edit"},[t("div",{staticClass:"ls-card"},[t("el-page-header",{attrs:{content:"add"===e.mode?"新建直播间":""},on:{back:function(t){return e.$router.go(-1)}}})],1),t("el-form",{ref:"formRef",attrs:{rules:e.formRules,model:e.form,"label-width":"120px",size:"small"}},[t("div",{staticClass:"ls-card m-t-16"},[t("div",{staticClass:"card-content m-t-24"},[t("el-form-item",{attrs:{label:"直播间标题",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入直播标题"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"直播类型",prop:"type"}},[t("el-radio-group",{staticClass:"m-r-16",model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-radio",{staticClass:"m-r-16",attrs:{label:0}},[e._v("手机直播")])],1),t("div",{staticClass:"muted xs m-r-16"},[e._v(" 通过“小程序直播/推流设备”开播 ")])],1),t("el-form-item",{attrs:{label:"开播时间",prop:""}},[t("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetime",placeholder:"请输入开播时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}),t("div",{staticClass:"muted xs m-r-16"},[e._v(" 填写直播开始时间，开播时间需要在当前时间的10分钟后并且不能在6个月后 ")])],1),t("el-form-item",{attrs:{label:"结束时间",prop:""}},[t("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetime",placeholder:"请输入结束时间",align:"right","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}),t("div",{staticClass:"muted xs m-r-16"},[e._v(" 开播时间和结束时间间隔不得短于30分钟，不得超过24小时 ")])],1),t("el-form-item",{attrs:{label:"主播昵称",prop:"anchor_name"}},[t("el-input",{attrs:{placeholder:"请输入主播昵称"},model:{value:e.form.anchor_name,callback:function(t){e.$set(e.form,"anchor_name",t)},expression:"form.anchor_name"}})],1),t("el-form-item",{attrs:{label:"主播微信号",prop:"anchor_wechat"}},[t("el-input",{attrs:{placeholder:"请输入主播微信号"},model:{value:e.form.anchor_wechat,callback:function(t){e.$set(e.form,"anchor_wechat",t)},expression:"form.anchor_wechat"}}),t("div",{staticClass:"muted xs m-r-16"},[e._v(" 每个直播间需要绑定主播微信号身份，用以核实主播身份，不会展示给观众。 ")])],1),t("el-form-item",{attrs:{label:"分享卡片封面",prop:"share_img"}},[t("live-upload",{on:{setImage:e.setShareImg}}),t("div",{staticClass:"muted xs m-r-16"},[e._v("用户在微信对话框内分享的直播间将以分享卡片的形式呈现。")]),t("div",{staticClass:"muted xs m-r-16"},[e._v("建议尺寸：800像素 * 640像素，图片大小不得超过1M。")])],1),t("el-form-item",{attrs:{label:"直播卡片封面",prop:"feeds_img"}},[t("live-upload",{on:{setImage:e.setFeedsImg}}),t("div",{staticClass:"muted xs m-r-16"},[e._v("图片建议大小为 800像素 * 800像素。图片大小不超过300KB。")])],1),t("el-form-item",{attrs:{label:"直播间背景墙",prop:"cover_img"}},[t("live-upload",{on:{setImage:e.setCoverImg}}),t("div",{staticClass:"muted xs m-r-16"},[e._v("直播间背景墙是每个直播间的默认背景。 建议尺寸：600像素 * 1300像素，图片大小不得超过3M")])],1),t("el-form-item",{attrs:{label:"直播间功能",prop:""}},[t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_like,callback:function(t){e.$set(e.form,"close_like",t)},expression:"form.close_like"}},[e._v("开启点赞")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_goods,callback:function(t){e.$set(e.form,"close_goods",t)},expression:"form.close_goods"}},[e._v("开启货架")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_comment,callback:function(t){e.$set(e.form,"close_comment",t)},expression:"form.close_comment"}},[e._v("开启评论")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_replay,callback:function(t){e.$set(e.form,"close_replay",t)},expression:"form.close_replay"}},[e._v("开启回放")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_share,callback:function(t){e.$set(e.form,"close_share",t)},expression:"form.close_share"}},[e._v("开启分享")]),t("el-checkbox",{attrs:{"true-label":0,"false-label":1},model:{value:e.form.close_kf,callback:function(t){e.$set(e.form,"close_kf",t)},expression:"form.close_kf"}},[e._v("开启客服")]),t("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.form.is_feeds_public,callback:function(t){e.$set(e.form,"is_feeds_public",t)},expression:"form.is_feeds_public"}},[e._v("开启官方收录 ")])],1)],1)])]),t("div",{staticClass:"bg-white ls-fixed-footer"},[t("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("保存")])],1)])],1)},i=[],l=s("9ab4"),o=s("1b40"),r=s("4201"),c=s("b3ad"),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{},[t("el-upload",{class:e.ishide?"hide":"",attrs:{action:e.action,headers:{token:e.$store.getters.token,version:e.version},"list-type":"picture-card",limit:1,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError}},[t("i",{staticClass:"el-icon-plus"})])],1)},d=[],m=s("d70b");let u=class extends o["e"]{constructor(){super(...arguments),this.action=m["a"].baseURL+"/adminapi/upload/wechatMaterial",this.version=m["a"].version,this.ishide=!1}handleRemove(e,t){console.log("删除成功",e,t),this.ishide=!1}handleSuccess(e,t,s){this.$emit("setImage",e.data.media_id),console.log("上传成功",e),this.ishide=!0}handleError(e,t){this.$message.error(t.name+"文件上传失败")}handleExceed(){this.$message.error("超出上传上限，请重新上传")}};u=Object(l["a"])([Object(o["a"])({components:{}})],u);var f=u,p=f,h=(s("3a4f"),s("2877")),b=Object(h["a"])(p,n,d,!1,null,"4d6cc57c",null),g=b.exports,v=s("623a");let _=class extends o["e"]{constructor(){super(...arguments),this.pickerOptions={shortcuts:[{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},this.mode=r["f"]["ADD"],this.form={type:0,name:"",start_time:0,end_time:0,anchor_name:"",anchor_wechat:"",cover_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",share_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",feeds_img:"U8e65h4PYWSpnMLKL0c8UGbDu_oowNJ-FtTGM6oE4PdkGNJJd6H89SN1mK1RbIRm",is_feeds_public:0,close_like:0,close_goods:0,close_comment:0,close_replay:0,close_share:0,close_kf:0},this.start="",this.end="",this.formRules={type:[{required:!0,message:"请选择直播类型",trigger:"change"}],name:[{required:!0,message:"请输入直播标题",trigger:"blur"}],start_time:[{required:!0,message:"请选择直播开始时间",trigger:"change"}],end_time:[{required:!0,message:"请选择直播结束时间",trigger:"change"}],anchor_name:[{required:!0,message:"请输入主播昵称",trigger:"blur"}],anchor_wechat:[{required:!0,message:"请输入主播微信号",trigger:"blur"}],cover_img:[{required:!0,message:"请选择直播间背景墙图片",trigger:"blur"}],share_img:[{required:!0,message:"请选择分享卡片封面图片",trigger:"blur"}],feeds_img:[{required:!0,message:"请选择直播卡片封面图片",trigger:"blur"}]}}setCoverImg(e){this.form.cover_img=e}setShareImg(e){this.form.share_img=e}setFeedsImg(e){this.form.feeds_img=e}onSubmit(){this.$refs.formRef.validate(e=>{e&&(console.log("发送请求"),this.liveRoomAdd())})}liveRoomAdd(){let e=new Date(this.start);this.form.start_time=e.getTime()/1e3;let t=new Date(this.end);this.form.end_time=t.getTime()/1e3,Object(v["d"])(this.form).then(e=>{setTimeout(()=>this.$router.go(-1),500)}).catch(e=>{console.log("err:",e)})}};_=Object(l["a"])([Object(o["a"])({components:{MaterialSelect:c["a"],LiveUpload:g}})],_);var k=_,x=k,y=(s("1abe"),Object(h["a"])(x,a,i,!1,null,"0428d5db",null));t["default"]=y.exports},"60a1":function(e,t,s){},"623a":function(e,t,s){"use strict";s.d(t,"f",(function(){return i})),s.d(t,"d",(function(){return l})),s.d(t,"e",(function(){return o})),s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return n}));var a=s("f175");const i=e=>a["a"].get("/live.LiveRoom/lists",{params:e}),l=e=>a["a"].post("/live.LiveRoom/add",e),o=e=>a["a"].post("/live.LiveRoom/del",e),r=e=>a["a"].get("/live.LiveGoods/lists",{params:e}),c=e=>a["a"].post("/live.LiveGoods/add",e),n=e=>a["a"].post("/live.LiveGoods/del",e)},ab28:function(e,t,s){},b3ad:function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("ls-dialog",{ref:"materialDialog",staticClass:"material-select",attrs:{title:"选择"+e.tipsText,width:"1050px",top:"15vh"},on:{confirm:e.handleConfirm}},[e.hiddenTrigger?e._e():t("div",{staticClass:"material-select__trigger clearfix",attrs:{slot:"trigger"},on:{click:function(e){e.stopPropagation()}},slot:"trigger"},[t("draggable",{staticClass:"ls-draggable",attrs:{animation:"300",disabled:e.disabled||e.dragDisabled},on:{update:e.handleChange},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},e._l(e.fileList,(function(s,a){return t("div",{key:s+a,staticClass:"material-preview ls-del-wrap",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!1,a)}}},[e.$scopedSlots.preview?t("div",[e._t("preview",null,{item:e.imageUri(s)})],2):t("file-item",{attrs:{type:e.type,item:{uri:e.imageUri(s)},size:e.size}}),e.enableDelete?t("i",{staticClass:"el-icon-close ls-icon-del",on:{click:function(t){return t.stopPropagation(),e.delImage(a)}}}):e._e()],1)})),0),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showUpload,expression:"showUpload"}],staticClass:"material-upload",class:{"is-disabled":e.disabled,"is-one":1==e.limit},on:{click:function(t){return e.showDialog(!0)}}},[e.$slots.upload?t("div",[e._t("upload")],2):t("div",{staticClass:"upload-btn flex row-center",style:{width:e.size+"px",height:e.size+"px",background:e.uploadBg}},[e._t("default"),e.$slots.default?e._e():t("span",[e._v("添加"+e._s(e.tipsText))])],2)])],1),t("div",{staticClass:"material-wrap"},[t("ls-material",{ref:"material",attrs:{"page-size":15,type:e.type,limit:e.meterialLimit},on:{change:e.selectChange}})],1)])},i=[],l=s("9ab4"),o=s("1b40"),r=s("0a6d"),c=s("c6fe"),n=s("e915"),d=s("b76a"),m=s.n(d);let u=class extends o["e"]{constructor(){super(...arguments),this.isAdd=!0,this.fileList=[]}get showUpload(){const{fileList:e,limit:t}=this;return t-e.length>0}get meterialLimit(){return this.isAdd?this.limit?this.limit-this.fileList.length:null:1}get tipsText(){switch(this.type){case"image":return"图片";case"video":return"视频"}}get imageUri(){return e=>this.enableDomain?e:this.$getImageUri(e)}valueChange(e){this.fileList=Array.isArray(e)?e:""==e?[]:[e]}showDialog(e=!0,t){var s;this.disabled||(this.isAdd=e,void 0!==t&&(this.currentIndex=t),null===(s=this.$refs.materialDialog)||void 0===s||s.onTrigger())}selectChange(e){this.select=e}handleConfirm(){this.$refs.material.clearSelectList();const e=this.select.map(e=>this.enableDomain?e.uri:e.url);this.isAdd?this.fileList=this.fileList.concat(e):this.fileList.splice(this.currentIndex,1,e.shift()),this.handleChange()}delImage(e){this.fileList.splice(e,1),this.handleChange()}handleChange(){const e=1!=this.limit?this.fileList:this.fileList[0]||"";this.$emit("input",e),this.$emit("change",e),this.fileList=[]}};Object(l["a"])([Object(o["c"])({default:()=>[]})],u.prototype,"value",void 0),Object(l["a"])([Object(o["c"])({default:1})],u.prototype,"limit",void 0),Object(l["a"])([Object(o["c"])({default:"100"})],u.prototype,"size",void 0),Object(l["a"])([Object(o["c"])({default:!1})],u.prototype,"disabled",void 0),Object(l["a"])([Object(o["c"])({default:!1})],u.prototype,"dragDisabled",void 0),Object(l["a"])([Object(o["c"])({default:!1})],u.prototype,"hiddenTrigger",void 0),Object(l["a"])([Object(o["c"])({default:"image"})],u.prototype,"type",void 0),Object(l["a"])([Object(o["c"])({default:"transparent"})],u.prototype,"uploadBg",void 0),Object(l["a"])([Object(o["c"])({default:!0})],u.prototype,"enableDomain",void 0),Object(l["a"])([Object(o["c"])({default:!0})],u.prototype,"enableDelete",void 0),Object(l["a"])([Object(o["f"])("value",{immediate:!0})],u.prototype,"valueChange",null),u=Object(l["a"])([Object(o["a"])({components:{LsDialog:r["a"],LsMaterial:c["a"],Draggable:m.a,FileItem:n["a"]}})],u);var f=u,p=f,h=(s("fb48"),s("2877")),b=Object(h["a"])(p,a,i,!1,null,"1503bff6",null);t["a"]=b.exports},fb48:function(e,t,s){"use strict";s("239d")}}]);
//# sourceMappingURL=chunk-5437e4e5.9cb56b23.js.map