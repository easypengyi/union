(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19ee5c80"],{"0cbf":function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"e",(function(){return a})),s.d(e,"g",(function(){return l})),s.d(e,"c",(function(){return n})),s.d(e,"h",(function(){return d})),s.d(e,"l",(function(){return u})),s.d(e,"k",(function(){return c})),s.d(e,"d",(function(){return r})),s.d(e,"f",(function(){return p})),s.d(e,"m",(function(){return _})),s.d(e,"i",(function(){return m})),s.d(e,"n",(function(){return b})),s.d(e,"j",(function(){return g})),s.d(e,"b",(function(){return f}));var o=s("f175");const i=t=>o["a"].post("/marketing.coupon/add",t),a=t=>o["a"].post("/marketing.coupon/edit",t),l=t=>o["a"].get("/marketing.coupon/lists",{params:t}),n=t=>o["a"].post("/marketing.coupon/delete",t),d=t=>o["a"].post("/marketing.coupon/open",t),u=t=>o["a"].post("/marketing.coupon/stop",t),c=t=>o["a"].post("/marketing.coupon/sort",t),r=t=>o["a"].get("/marketing.coupon/detail",{params:{id:t}}),p=t=>o["a"].get("/marketing.coupon/info",{params:{id:t}}),_=()=>o["a"].get("/marketing.coupon/survey"),m=t=>o["a"].get("/marketing.coupon/record",{params:t}),b=t=>o["a"].post("/marketing.coupon/void",t),g=t=>o["a"].post("/marketing.coupon/send",t),f=t=>o["a"].get("/marketing.coupon/commonLists",{params:t})},"54a9":function(t,e,s){},"54df":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"ls-coupon-edit"},[e("div",{staticClass:"ls-card ls-coupon-edit__header"},[0==t.status?e("el-page-header",{attrs:{content:"优惠券详情"},on:{back:function(e){return t.$router.go(-1)}}}):e("el-page-header",{attrs:{content:t.id?"编辑优惠券活动":"新增优惠券活动"},on:{back:function(e){return t.$router.go(-1)}}})],1),e("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[e("div",{staticClass:"lg weight-500 m-b-20"},[t._v("基本信息")]),e("el-form",{ref:"couponList",attrs:{rules:t.rules,model:t.couponList,"label-width":"120px",size:"small"}},[e("el-form-item",{attrs:{label:"优惠券名称",prop:"name",required:""}},[e("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,placeholder:"请输入优惠券名称"},model:{value:t.couponList.name,callback:function(e){t.$set(t.couponList,"name",e)},expression:"couponList.name"}})],1),e("el-form-item",{attrs:{label:"发放总量",prop:"send_total_type"}},[e("div",[e("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:1},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 不限制数量")])],1),e("div",{staticClass:"flex m-t-24"},[e("el-radio",{attrs:{border:"",disabled:2!=t.status&&t.disabled,label:2},model:{value:t.couponList.send_total_type,callback:function(e){t.$set(t.couponList,"send_total_type",e)},expression:"couponList.send_total_type"}},[t._v(" 发放 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:2!=t.status&&t.disabled,size:"small"},model:{value:t.couponList.send_total,callback:function(e){t.$set(t.couponList,"send_total",e)},expression:"couponList.send_total"}},[e("template",{slot:"append"},[t._v("张")])],2)],1),e("span",{staticClass:"desc"},[t._v("编辑进行中的优惠券，发放总量只能增加不能减少，请谨慎设置。最多1000000张。")])]),e("el-form-item",{attrs:{label:"用券时间",prop:"send_total_type"}},[e("div",{staticClass:"m-b-24"},[e("el-radio",{attrs:{disabled:t.disabled,label:1},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v("固定日期")]),e("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"开始日期"},model:{value:t.couponList.use_time_start,callback:function(e){t.$set(t.couponList,"use_time_start",e)},expression:"couponList.use_time_start"}}),t._v(" 至 "),e("el-date-picker",{attrs:{disabled:t.disabled,type:"datetime",placeholder:"结束日期"},model:{value:t.couponList.use_time_end,callback:function(e){t.$set(t.couponList,"use_time_end",e)},expression:"couponList.use_time_end"}}),t._v(" 可用 ")],1),e("div",{staticClass:"flex"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券当日起 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time,callback:function(e){t.$set(t.couponList,"use_time",e)},expression:"couponList.use_time"}},[e("template",{slot:"append"},[t._v("天内可用")])],2)],1),e("span",{staticClass:"desc"},[t._v("至少需要填写1天")]),e("div",{staticClass:"flex"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_time_type,callback:function(e){t.$set(t.couponList,"use_time_type",e)},expression:"couponList.use_time_type"}},[t._v(" 领券次日起 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.use_time1,callback:function(e){t.$set(t.couponList,"use_time1",e)},expression:"couponList.use_time1"}},[e("template",{slot:"append"},[t._v("天内可用")])],2)],1),e("span",{staticClass:"desc"},[t._v("至少需要填写1天")])])],1)],1),e("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[e("div",{staticClass:"lg weight-500 m-b-20"},[t._v("优惠设置")]),e("el-form",{ref:"couponList",attrs:{model:t.couponList,"label-width":"120px",size:"small"}},[e("el-form-item",{attrs:{label:"优惠券面额",prop:"money",required:""}},[e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled},model:{value:t.couponList.money,callback:function(e){t.$set(t.couponList,"money",e)},expression:"couponList.money"}}),e("span",{staticClass:"desc"},[t._v("面额需大于0元，支持两位小数")])],1),e("el-form-item",{attrs:{label:"使用门槛",prop:"condition_type"}},[e("div",[e("el-radio",{attrs:{disabled:t.disabled,border:"",label:1},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v("无门槛使用 ")])],1),e("div",{staticClass:"flex m-t-24"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.condition_type,callback:function(e){t.$set(t.couponList,"condition_type",e)},expression:"couponList.condition_type"}},[t._v(" 订单满 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.condition_money,callback:function(e){t.$set(t.couponList,"condition_money",e)},expression:"couponList.condition_money"}},[e("template",{slot:"append"},[t._v("元可使用")])],2)],1),e("span",{staticClass:"desc"},[t._v("需要填写大于优惠券面额的数额")])]),e("el-form-item",{attrs:{label:"使用范围",prop:"use_goods_type"}},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("全场通用")]),e("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品可用 ")]),e("el-radio",{attrs:{border:"",disabled:t.disabled,label:3},model:{value:t.couponList.use_goods_type,callback:function(e){t.$set(t.couponList,"use_goods_type",e)},expression:"couponList.use_goods_type"}},[t._v("部分商品不可用 ")]),1!==t.couponList.use_goods_type?e("div",{staticClass:"m-t-24"},[t.disabled?t._e():e("goods-select",{attrs:{mode:"ll"},model:{value:t.goodsSelectData,callback:function(e){t.goodsSelectData=e},expression:"goodsSelectData"}},[e("el-button",{attrs:{slot:"trigger",disabled:t.disabled,size:"small",type:"primary"},slot:"trigger"},[t._v("选择商品")])],1),0!=t.goodsSelectData.length?e("el-table",{ref:"paneTable",staticClass:"m-t-24",staticStyle:{width:"100%"},attrs:{size:"small",data:t.goodsSelectData}},[e("el-table-column",{attrs:{prop:"id",label:"商品编码",width:"110"}}),e("el-table-column",{attrs:{label:"商品信息","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"flex"},[e("el-image",{staticClass:"flex-none",staticStyle:{width:"58px",height:"58px"},attrs:{src:s.row.image}}),e("div",{staticClass:"goods-info m-l-8"},[e("div",{staticClass:"line-2"},[t._v(t._s(s.row.name))])])],1)]}}],null,!1,977849216)}),e("el-table-column",{attrs:{label:"价格",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.max_price)+" ")]}}],null,!1,1062266139)}),e("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{disabled:t.disabled,type:"text",size:"small"},on:{click:function(e){return t.removeSelectGoods(s.row.id)}}},[t._v("移除")])]}}],null,!1,1973233545)})],1):t._e()],1):t._e()],1)],1)],1),e("div",{staticClass:"ls-card ls-coupon-edit__form m-t-10"},[e("div",{staticClass:"lg weight-500 m-b-20"},[t._v("发放设置")]),e("el-form",{ref:"couponList",attrs:{model:t.couponList,"label-width":"120px",size:"small"}},[e("el-form-item",{attrs:{label:"推广方式",prop:"get_type",required:""}},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:1},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("买家领取")]),e("el-radio",{attrs:{border:"",disabled:t.disabled,label:2},model:{value:t.couponList.get_type,callback:function(e){t.$set(t.couponList,"get_type",e)},expression:"couponList.get_type"}},[t._v("卖家发放")])],1),e("el-form-item",{attrs:{label:"领取次数",prop:"get_num_type"}},[e("el-radio-group",{model:{value:t.couponList.get_num_type,callback:function(e){t.$set(t.couponList,"get_num_type",e)},expression:"couponList.get_num_type"}},[e("div",{staticClass:"m-t-10"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:1}},[t._v("不限制领取次数")])],1),e("div",{staticClass:"m-t-24 flex"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:2}},[t._v(" 限制领取 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num,callback:function(e){t.$set(t.couponList,"get_num",e)},expression:"couponList.get_num"}},[e("template",{slot:"append"},[t._v("次")])],2)],1),e("div",{staticClass:"m-t-24 flex"},[e("el-radio",{attrs:{border:"",disabled:t.disabled,label:3}},[t._v(" 每天限制领取 ")]),e("el-input",{staticClass:"ls-input",attrs:{disabled:t.disabled,size:"small"},model:{value:t.couponList.get_num1,callback:function(e){t.$set(t.couponList,"get_num1",e)},expression:"couponList.get_num1"}},[e("template",{slot:"append"},[t._v("次")])],2)],1)]),e("span",{staticClass:"desc"},[t._v("领取次数只对买家领取的场景有效")])],1)],1)],1),e("div",{staticClass:"ls-coupon-edit__footer bg-white ls-fixed-footer"},[e("div",{staticClass:"btns row-center flex",staticStyle:{height:"100%"}},[e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),e("el-button",{attrs:{size:"small",disabled:2!=t.status&&t.disabled,type:"primary"},on:{click:function(e){return t.submit("couponList")}}},[t._v("保存")])],1)])])},i=[],a=s("9ab4"),l=s("1b40"),n=s("5cf7"),d=s("f50c"),u=s("0cbf");let c=class extends l["e"]{constructor(){super(...arguments),this.disabled=!1,this.status=0,this.couponList={name:"",money:"",condition_type:1,condition_money:"",send_total_type:1,send_total:"",use_time_type:1,use_time_start:"",use_time_end:"",use_time:"",use_time1:"",get_type:1,get_num_type:1,get_num:"",get_num1:"",use_goods_type:1,use_goods_ids:[]},this.goodsSelectData=[],this.rules={name:[{required:!0,message:"请输入优惠券名称",trigger:["blur","change"]}],money:[{required:!0,message:"请输入优惠券面额",trigger:["blur","change"]}],send_total:[{required:!0,message:"请输入发放数量",trigger:["blur","change"]}]}}add(t){return t<10?"0"+t:t}baseTime(t){const e=new Date(t);return`${this.add(e.getFullYear())}-${this.add(e.getMonth()+1)}-${this.add(e.getDate())} ${this.add(e.getHours())}:${this.add(e.getMinutes())}:${this.add(e.getSeconds())}`}startTime(t){this.couponList.use_time_start=this.baseTime(t)}endTime(t){this.couponList.use_time_end=this.baseTime(t)}goodsData(t){t.length<=0||(this.goodsSelectData=t)}removeSelectGoods(t){console.log(t);for(let e=0;e<this.goodsSelectData.length;e++)this.goodsSelectData[e].id==t&&this.goodsSelectData.splice(e,1)}submit(t){const e=this.$refs[t];e.validate(t=>{t&&(3==this.couponList.get_num_type&&(this.couponList.get_num=this.couponList.get_num1),3==this.couponList.use_time_type&&(this.couponList.use_time=this.couponList.use_time1),1!==this.couponList.use_goods_type?this.couponList.use_goods_ids=this.goodsSelectData.map(t=>t.id):this.couponList.use_goods_ids=[],this.id?this.couponEdit():this.couponAdd())})}couponEdit(){Object(u["e"])({...this.couponList}).then(t=>{setTimeout(()=>this.$router.go(-1),500)})}couponAdd(){Object(u["a"])({...this.couponList}).then(t=>{setTimeout(()=>this.$router.go(-1),500)})}getCouponDetail(){Object(u["d"])(this.id).then(t=>{3==t.get_num_type&&(t.get_num1=t.get_num,t.get_num=""),3==t.use_time_type&&(t.use_time1=t.use_time,t.use_time=""),t.goods&&(this.goodsSelectData=t.goods),this.couponList=t})}created(){this.status=this.$route.query.status,this.disabled="true"==this.$route.query.disabled,this.id=this.$route.query.id,this.id&&this.getCouponDetail()}};c=Object(a["a"])([Object(l["a"])({components:{AreaSelect:n["a"],GoodsSelect:d["a"]}})],c);var r=c,p=r,_=(s("da8f"),s("2877")),m=Object(_["a"])(p,o,i,!1,null,"e27f60ca",null);e["default"]=m.exports},"5cf7":function(t,e,s){"use strict";var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"area-select"},[e("el-cascader",{style:{width:t.width},attrs:{options:t.options},model:{value:t.areaValue,callback:function(e){t.areaValue=e},expression:"areaValue"}})],1)},i=[],a=s("9ab4"),l=s("0463"),n=s("1b40");let d=class extends n["e"]{constructor(){super(...arguments),this.options=l["a"]}get areaValue(){return[this.province,this.city,this.district]}set areaValue(t){this.$emit("update:province",t[0]),this.$emit("update:city",t[1]),this.$emit("update:district",t[2])}};Object(a["a"])([Object(n["c"])()],d.prototype,"province",void 0),Object(a["a"])([Object(n["c"])()],d.prototype,"city",void 0),Object(a["a"])([Object(n["c"])()],d.prototype,"district",void 0),Object(a["a"])([Object(n["c"])({default:"380px"})],d.prototype,"width",void 0),d=Object(a["a"])([n["a"]],d);var u=d,c=u,r=s("2877"),p=Object(r["a"])(c,o,i,!1,null,null,null);e["a"]=p.exports},da8f:function(t,e,s){"use strict";s("54a9")}}]);
//# sourceMappingURL=chunk-19ee5c80.b1c87694.js.map