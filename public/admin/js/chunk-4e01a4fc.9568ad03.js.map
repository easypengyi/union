{"version":3,"sources":["webpack:///./src/views/setting/permissions/role_edit.vue","webpack:///./src/views/setting/permissions/role_edit.vue?4f29","webpack:///./src/views/setting/permissions/role_edit.vue?8141","webpack:///./src/views/setting/permissions/role_edit.vue?d86f","webpack:///./src/api/setting/permissions.ts","webpack:///./src/views/setting/permissions/role_edit.vue?c417"],"names":["render","_vm","this","_c","_self","_setupProxy","staticClass","attrs","on","$event","$router","go","ref","form","rules","model","value","name","callback","$$v","$set","expression","minRows","maxRows","desc","permissionsTree","children","label","handlePermissionsCheckChange","staticStyle","_v","submitForm","staticRenderFns","RoleEdit","Vue","constructor","mode","PageMode","identity","auth_keys","required","message","trigger","data","checked","console","log","auth_key","index","findIndex","item","push","splice","formName","$refs","validate","valid","$message","error","handleRoleAdd","handleRoleEdit","params","apiRoleAdd","then","setTimeout","catch","id","apiRoleEdit","initFormDataForRoleEdit","apiRoleDetail","res","Object","keys","map","setCheckedKeys","getAuthMenu","apiAuthMenu","created","query","$route","Component","component","apiAdminList","request","get","apiAdminDetail","apiAdminAdd","post","apiAdminDelete","apiAdminEdit","apiRoleList","apiRoleDelete"],"mappings":"kJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAUF,EAAIG,MAAMC,YAAY,OAAOF,EAAG,MAAM,CAACG,YAAY,eAAe,CAACH,EAAG,MAAM,CAACG,YAAY,WAAW,CAACH,EAAG,iBAAiB,CAACI,MAAM,CAAC,QAAU,QAAQC,GAAG,CAAC,KAAO,SAASC,GAAQ,OAAOR,EAAIS,QAAQC,IAAI,QAAQ,GAAGR,EAAG,MAAM,CAACG,YAAY,kBAAkB,CAACH,EAAG,UAAU,CAACS,IAAI,OAAOL,MAAM,CAAC,MAAQN,EAAIY,KAAK,MAAQZ,EAAIa,MAAM,cAAc,QAAQ,KAAO,UAAU,CAACX,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,KAAK,SAAW,GAAG,KAAO,SAAS,CAACJ,EAAG,WAAW,CAACG,YAAY,WAAWC,MAAM,CAAC,UAAY,IAAI,kBAAkB,GAAG,YAAc,SAASQ,MAAM,CAACC,MAAOf,EAAIY,KAAKI,KAAMC,SAAS,SAAUC,GAAMlB,EAAImB,KAAKnB,EAAIY,KAAM,OAAQM,IAAME,WAAW,gBAAgB,GAAGlB,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,CAACJ,EAAG,WAAW,CAACG,YAAY,WAAWC,MAAM,CAAC,KAAO,WAAW,SAAW,CAAEe,QAAS,EAAGC,QAAS,GAAI,YAAc,YAAYR,MAAM,CAACC,MAAOf,EAAIY,KAAKW,KAAMN,SAAS,SAAUC,GAAMlB,EAAImB,KAAKnB,EAAIY,KAAM,OAAQM,IAAME,WAAW,gBAAgB,GAAGlB,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,CAACJ,EAAG,UAAU,CAACS,IAAI,kBAAkBL,MAAM,CAAC,KAAON,EAAIwB,gBAAgB,WAAW,WAAW,qBAAqB,GAAG,aAAa,sBAAsB,MAAQ,CAC3pCC,SAAU,OACVC,MAAO,QACT,aAAa,GAAG,gBAAgB,IAAInB,GAAG,CAAC,eAAeP,EAAI2B,iCAAiC,IAAI,IAAI,GAAGzB,EAAG,MAAM,CAACG,YAAY,4BAA4B,CAACH,EAAG,MAAM,CAACG,YAAY,kBAAkBuB,YAAY,CAAC,OAAS,SAAS,CAAC1B,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,SAASC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,QAAQC,IAAI,MAAM,CAACV,EAAI6B,GAAG,QAAQ3B,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,QAAQ,KAAO,WAAWC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAI8B,WAAW,WAAW,CAAC9B,EAAI6B,GAAG,SAAS,QAE5eE,EAAkB,G,gDCOtB,IAAqBC,EAArB,cAAsCC,OAAtCC,c,oBAEI,KAAAC,KAAeC,OAAS,OACxB,KAAAC,SAA0B,KAG1B,KAAAzB,KAAoB,CAChBI,KAAM,GACNsB,UAAW,GACXf,KAAM,IAIV,KAAAC,gBAA4B,GAG5B,KAAAX,MAAgB,CACZG,KAAM,CAAC,CAAEuB,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAM1Dd,6BAA6Be,EAAWC,GAEpC,GADAC,QAAQC,IAAIH,IACPA,EAAKI,SACN,OAEJ,IAAIC,EAAQ9C,KAAKW,KAAK0B,UAAUU,UAC3BC,GAASA,GAAQP,EAAKI,UAEvBH,GACU,GAAVI,GAAe9C,KAAKW,KAAK0B,UAAUY,KAAKR,EAAKI,WAInC,GAAVC,GACA9C,KAAKW,KAAK0B,UAAUa,OAAOJ,EAAO,GAK1CjB,WAAWsB,GACP,MAAMzC,EAAMV,KAAKoD,MAAMD,GACvBzC,EAAI2C,SAAUC,IACV,IAAKA,EAAO,OAAOtD,KAAKuD,SAASC,MAAM,SAGvC,OAAQxD,KAAKkC,MACT,KAAKC,OAAS,OACV,OAAOnC,KAAKyD,gBAChB,KAAKtB,OAAS,QACV,OAAOnC,KAAK0D,oBAM5BD,gBACI,MAAME,EAAS3D,KAAKW,KACpBiD,eAAWD,GACNE,KAAK,KACFC,WAAW,IAAM9D,KAAKQ,QAAQC,IAAI,GAAI,OAEzCsD,MAAM,QAKfL,iBACI,MAAMC,EAAS3D,KAAKW,KACdqD,EAAahE,KAAKoC,SACxB6B,eAAY,IAAKN,EAAQK,OACpBH,KAAK,KACFC,WAAW,IAAM9D,KAAKQ,QAAQC,IAAI,GAAI,OAEzCsD,MAAM,QAMfG,0BACI,MAAMF,EAAahE,KAAKoC,SACxB+B,eAAc,CAAEH,OACXH,KAAMO,IACHC,OAAOC,KAAKF,GAAKG,IAAKvB,IAClBhD,KAAKkB,KAAKlB,KAAKW,KAAMqC,EAAMoB,EAAIpB,MAEnChD,KAAKW,KAAK0B,UAAY,GACtB,MAAM3B,EAAMV,KAAKoD,MAAM,mBACvB1C,EAAI8D,eAAeJ,EAAI/B,aAE1B0B,MAAM,QAKfU,cACIC,iBAAcb,KAAMO,IAChBpE,KAAKuB,gBAAkB6C,IAO/BO,UACI,MAAMC,EAAa5E,KAAK6E,OAAOD,MAC3BA,EAAM1C,OAAMlC,KAAKkC,KAAO0C,EAAM1C,MAE9BlC,KAAKkC,OAASC,OAAS,UACvBnC,KAAKoC,SAAsB,EAAXwC,EAAMZ,GACtBhE,KAAKkE,2BAETlE,KAAKyE,gBAnHQ1C,EAAQ,gBAD5B+C,QACoB/C,WCZmZ,I,wBCQpagD,EAAY,eACd,EACAjF,EACAgC,GACA,EACA,KACA,WACA,MAIa,aAAAiD,E,6CCnBf,sYAMO,MAAMC,EAAgBrB,GACzBsB,OAAQC,IAAI,oBAAqB,CAAEvB,WAG1BwB,EAAkBxB,GAC3BsB,OAAQC,IAAI,qBAAsB,CAAEvB,WAG3ByB,EAAe3C,GACxBwC,OAAQI,KAAK,kBAAmB5C,GAGvB6C,EAAkB7C,GAC3BwC,OAAQI,KAAK,qBAAsB5C,GAG1B8C,EAAgB9C,GACzBwC,OAAQI,KAAK,mBAAoB5C,GAQxB+C,EAAe7B,GACxBsB,OAAQC,IAAI,mBAAoB,CAAEvB,WAGzBQ,EAAiBR,GAC1BsB,OAAQC,IAAI,oBAAqB,CAAEvB,WAG1BC,EAAcnB,GACvBwC,OAAQI,KAAK,iBAAkB5C,GAGtBwB,EAAexB,GACxBwC,OAAQI,KAAK,kBAAmB5C,GAGvBgD,EAAiBhD,GAC1BwC,OAAQI,KAAK,oBAAqB5C,GAGzBiC,EAAc,IAAMO,OAAQI,KAAK,oB,kCCnD9C","file":"js/chunk-4e01a4fc.9568ad03.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"ls-add-role\"},[_c('div',{staticClass:\"ls-card\"},[_c('el-page-header',{attrs:{\"content\":\"编辑角色\"},on:{\"back\":function($event){return _vm.$router.go(-1)}}})],1),_c('div',{staticClass:\"ls-card m-t-10\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"120px\",\"size\":\"small\"}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"required\":\"\",\"prop\":\"name\"}},[_c('el-input',{staticClass:\"ls-input\",attrs:{\"maxlength\":\"8\",\"show-word-limit\":\"\",\"placeholder\":\"请输入名称\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"描述\"}},[_c('el-input',{staticClass:\"ls-input\",attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 3, maxRows: 4 },\"placeholder\":\"请描述一下该角色\"},model:{value:(_vm.form.desc),callback:function ($$v) {_vm.$set(_vm.form, \"desc\", $$v)},expression:\"form.desc\"}})],1),_c('el-form-item',{attrs:{\"label\":\"权限\"}},[_c('el-tree',{ref:\"permissionsTree\",attrs:{\"data\":_vm.permissionsTree,\"node-key\":\"auth_key\",\"default-expand-all\":\"\",\"icon-class\":\"el-icon-arrow-right\",\"props\":{\n                        children: 'sons',\n                        label: 'name'\n                    },\"empty-text\":\"\",\"show-checkbox\":\"\"},on:{\"check-change\":_vm.handlePermissionsCheckChange}})],1)],1)],1),_c('div',{staticClass:\"bg-white ls-fixed-footer\"},[_c('div',{staticClass:\"row-center flex\",staticStyle:{\"height\":\"100%\"}},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('form')}}},[_vm._v(\"保存\")])],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Vue } from 'vue-property-decorator'\nimport {\n    apiRoleAdd,\n    apiRoleEdit,\n    apiRoleDetail,\n    apiAuthMenu,\n} from '@/api/setting/permissions'\nimport { RoleAdd_Req } from '@/api/setting/permissions.d'\nimport { PageMode } from '@/utils/type'\n\n@Component\nexport default class RoleEdit extends Vue {\n    /** S Data **/\n    mode: string = PageMode['ADD'] // 当前页面【add: 添加角色 | edit: 编辑角色】\n    identity: number | null = null // 当前编辑用户的身份ID  valid: mode = 'edit'\n\n    // 表单数据\n    form: RoleAdd_Req = {\n        name: '',\n        auth_keys: [],\n        desc: '',\n    }\n\n    // 权限树\n    permissionsTree: object[] = []\n\n    // 表单验证\n    rules: object = {\n        name: [{ required: true, message: '必填项不可为空', trigger: 'blur' }],\n    }\n\n    /** E Data **/\n\n    /** S Methods **/\n    handlePermissionsCheckChange(data: any, checked: boolean) {\n        console.log(data)\n        if (!data.auth_key) {\n            return\n        }\n        let index = this.form.auth_keys.findIndex(\n            (item) => item == data.auth_key\n        )\n        if (checked) {\n            index == -1 && this.form.auth_keys.push(data.auth_key)\n            return\n        }\n       \n        if (index != -1) {\n            this.form.auth_keys.splice(index, 1)\n        }\n    }\n\n    // 表单提交\n    submitForm(formName: string) {\n        const ref = this.$refs[formName] as HTMLFormElement\n        ref.validate((valid: boolean) => {\n            if (!valid) return this.$message.error('请完善信息')\n\n            // 请求发送\n            switch (this.mode) {\n                case PageMode['ADD']:\n                    return this.handleRoleAdd()\n                case PageMode['EDIT']:\n                    return this.handleRoleEdit()\n            }\n        })\n    }\n\n    // 添加角色\n    handleRoleAdd() {\n        const params = this.form\n        apiRoleAdd(params)\n            .then(() => {\n                setTimeout(() => this.$router.go(-1), 500)\n            })\n            .catch(() => {\n            })\n    }\n\n    // 编辑角色\n    handleRoleEdit() {\n        const params = this.form\n        const id: number = this.identity as number\n        apiRoleEdit({ ...params, id })\n            .then(() => {\n                setTimeout(() => this.$router.go(-1), 500)\n            })\n            .catch(() => {\n                \n            })\n    }\n\n    // 初始化表单数据: 角色编辑\n    initFormDataForRoleEdit() {\n        const id: number = this.identity as number\n        apiRoleDetail({ id })\n            .then((res) => {\n                Object.keys(res).map((item) => {\n                    this.$set(this.form, item, res[item])\n                })\n                this.form.auth_keys = []\n                const ref = this.$refs['permissionsTree'] as any\n                ref.setCheckedKeys(res.auth_keys);\n            })\n            .catch(() => {\n            })\n    }\n\n    // 获取权限菜单\n    getAuthMenu() {\n        apiAuthMenu().then((res) => {\n            this.permissionsTree = res\n        })\n    }\n\n    /** E Methods **/\n\n    /** S Life Cycle **/\n    created() {\n        const query: any = this.$route.query\n        if (query.mode) this.mode = query.mode\n\n        if (this.mode === PageMode['EDIT']) {\n            this.identity = query.id * 1\n            this.initFormDataForRoleEdit()\n        }\n        this.getAuthMenu()\n    }\n\n    /** S Life Cycle **/\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./role_edit.vue?vue&type=template&id=d898fef8&scoped=true&\"\nimport script from \"./role_edit.vue?vue&type=script&lang=ts&\"\nexport * from \"./role_edit.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./role_edit.vue?vue&type=style&index=0&id=d898fef8&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d898fef8\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/plugins/axios'\nimport * as Interface from '@/api/setting/permissions.d'\n\n\n/** S 管理员 **/\n// 管理员列表 \nexport const apiAdminList = (params: Interface.AdminList_Req): Promise<Interface.AdminList_Res> =>\n    request.get('/auth.admin/lists', { params })\n\n// 管理员详情\nexport const apiAdminDetail = (params: Interface.AdminDetail_Req): Promise<Interface.AdminDetail_Res> =>\n    request.get('/auth.admin/detail', { params })\n\n// 添加管理员\nexport const apiAdminAdd = (data: Interface.AdminAdd_Req): Promise<any> =>\n    request.post('/auth.admin/add', data)\n\n// 删除管理员\nexport const apiAdminDelete = (data: Interface.AdminDelete_Req): Promise<any> =>\n    request.post('/auth.admin/delete', data)\n\n// 编辑管理员\nexport const apiAdminEdit = (data: Interface.AdminEdit_Req): Promise<any> =>\n    request.post('/auth.admin/edit', data)\n\n/** E 管理员 **/\n\n\n\n/** S 角色 **/\n// 角色列表\nexport const apiRoleList = (params?: Interface.RoleList_Req): Promise<Interface.RoleList_Res> =>\n    request.get('/auth.role/lists', { params })\n\n// 角色详情\nexport const apiRoleDetail = (params: Interface.RoleDetail_Req): Promise<Interface.RoleDetail_Res> =>\n    request.get('/auth.role/detail', { params })\n\n// 添加角色\nexport const apiRoleAdd = (data: Interface.RoleAdd_Req): Promise<any> =>\n    request.post('/auth.role/add', data)\n\n// 编辑角色\nexport const apiRoleEdit = (data: Interface.RoleEdit_Req): Promise<any> =>\n    request.post('/auth.role/edit', data)\n\n// 删除角色\nexport const apiRoleDelete = (data: Interface.RoleDelete_Req): Promise<any> =>\n    request.post('/auth.role/delete', data)\n\n// 权限菜单\nexport const apiAuthMenu = () => request.post('/config/getMenu')\n/** E 角色 **/","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./role_edit.vue?vue&type=style&index=0&id=d898fef8&prod&lang=scss&scoped=true&\""],"sourceRoot":""}