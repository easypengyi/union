(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e01a4fc"],{"26ed":function(t,e,s){},"2c6e":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"ls-add-role"},[e("div",{staticClass:"ls-card"},[e("el-page-header",{attrs:{content:"编辑角色"},on:{back:function(e){return t.$router.go(-1)}}})],1),e("div",{staticClass:"ls-card m-t-10"},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",size:"small"}},[e("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[e("el-input",{staticClass:"ls-input",attrs:{maxlength:"8","show-word-limit":"",placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{staticClass:"ls-input",attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"请描述一下该角色"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),e("el-form-item",{attrs:{label:"权限"}},[e("el-tree",{ref:"permissionsTree",attrs:{data:t.permissionsTree,"node-key":"auth_key","default-expand-all":"","icon-class":"el-icon-arrow-right",props:{children:"sons",label:"name"},"empty-text":"","show-checkbox":""},on:{"check-change":t.handlePermissionsCheckChange}})],1)],1)],1),e("div",{staticClass:"bg-white ls-fixed-footer"},[e("div",{staticClass:"row-center flex",staticStyle:{height:"100%"}},[e("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("保存")])],1)])])},i=[],a=s("9ab4"),n=s("1b40"),o=s("68eb"),l=s("4201");let u=class extends n["e"]{constructor(){super(...arguments),this.mode=l["f"]["ADD"],this.identity=null,this.form={name:"",auth_keys:[],desc:""},this.permissionsTree=[],this.rules={name:[{required:!0,message:"必填项不可为空",trigger:"blur"}]}}handlePermissionsCheckChange(t,e){if(console.log(t),!t.auth_key)return;let s=this.form.auth_keys.findIndex(e=>e==t.auth_key);e?-1==s&&this.form.auth_keys.push(t.auth_key):-1!=s&&this.form.auth_keys.splice(s,1)}submitForm(t){const e=this.$refs[t];e.validate(t=>{if(!t)return this.$message.error("请完善信息");switch(this.mode){case l["f"]["ADD"]:return this.handleRoleAdd();case l["f"]["EDIT"]:return this.handleRoleEdit()}})}handleRoleAdd(){const t=this.form;Object(o["g"])(t).then(()=>{setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{})}handleRoleEdit(){const t=this.form,e=this.identity;Object(o["j"])({...t,id:e}).then(()=>{setTimeout(()=>this.$router.go(-1),500)}).catch(()=>{})}initFormDataForRoleEdit(){const t=this.identity;Object(o["i"])({id:t}).then(t=>{Object.keys(t).map(e=>{this.$set(this.form,e,t[e])}),this.form.auth_keys=[];const e=this.$refs["permissionsTree"];e.setCheckedKeys(t.auth_keys)}).catch(()=>{})}getAuthMenu(){Object(o["f"])().then(t=>{this.permissionsTree=t})}created(){const t=this.$route.query;t.mode&&(this.mode=t.mode),this.mode===l["f"]["EDIT"]&&(this.identity=1*t.id,this.initFormDataForRoleEdit()),this.getAuthMenu()}};u=Object(a["a"])([n["a"]],u);var c=u,d=c,h=(s("ca11"),s("2877")),m=Object(h["a"])(d,r,i,!1,null,"d898fef8",null);e["default"]=m.exports},"68eb":function(t,e,s){"use strict";s.d(e,"e",(function(){return i})),s.d(e,"c",(function(){return a})),s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"d",(function(){return l})),s.d(e,"k",(function(){return u})),s.d(e,"i",(function(){return c})),s.d(e,"g",(function(){return d})),s.d(e,"j",(function(){return h})),s.d(e,"h",(function(){return m})),s.d(e,"f",(function(){return f}));var r=s("f175");const i=t=>r["a"].get("/auth.admin/lists",{params:t}),a=t=>r["a"].get("/auth.admin/detail",{params:t}),n=t=>r["a"].post("/auth.admin/add",t),o=t=>r["a"].post("/auth.admin/delete",t),l=t=>r["a"].post("/auth.admin/edit",t),u=t=>r["a"].get("/auth.role/lists",{params:t}),c=t=>r["a"].get("/auth.role/detail",{params:t}),d=t=>r["a"].post("/auth.role/add",t),h=t=>r["a"].post("/auth.role/edit",t),m=t=>r["a"].post("/auth.role/delete",t),f=()=>r["a"].post("/config/getMenu")},ca11:function(t,e,s){"use strict";s("26ed")}}]);
//# sourceMappingURL=chunk-4e01a4fc.9568ad03.js.map