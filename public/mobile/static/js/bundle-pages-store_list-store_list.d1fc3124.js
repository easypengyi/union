(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bundle-pages-store_list-store_list"],{"2bab":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,"@charset \"UTF-8\";\n/* 颜色变量 */\n/** S Font's size **/\n/** E Font's size **/[data-v-2bbc84fc]:export{red_theme:#ff2c3c;orange_theme:#f7971e;pink_theme:#fa444d;gold_theme:#e0a356;blue_theme:#2f80ed;green_theme:#2ec840}uni-page-body[data-v-2bbc84fc]{padding:0;margin:0;height:100%}.store-list[data-v-2bbc84fc]{display:flex;flex-direction:column;height:100%;overflow:hidden}.store[data-v-2bbc84fc]{flex:1}.store-item[data-v-2bbc84fc]{padding:%?30?%;border-radius:%?14?%}.store-item-phone[data-v-2bbc84fc]{display:flex;align-items:center;justify-content:center;width:%?60?%;height:%?60?%;margin-right:%?10?%;border:1px solid #101010;border-radius:50%}",""]),t.exports=e},"55da":function(t,e,n){var a=n("2bab");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("cebc7432",a,!0,{sourceMap:!1,shadowMode:!1})},"565d":function(t,e,n){"use strict";var a=n("4ea4");n("99af"),n("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("3835"));n("96cf");var r=a(n("1da1")),s=a(n("2909")),o=a(n("5530")),c=n("db19"),u=a(n("4548")),l={name:"StoreList",mixins:[u.default],data:function(){return{lists:[],location:{},markers:[]}},methods:{upCallback:function(t){var e=this;(0,c.apiSelffetchStore)((0,o.default)((0,o.default)({},this.location),{},{page_no:t.num,page_size:t.size})).then((function(n){var a=n.lists,i=(n.page_size,n.count);1===t.num&&(e.lists=[]),e.lists=[].concat((0,s.default)(e.lists),(0,s.default)(a)),e.markers=a.map((function(t){return{id:t.id,latitude:t.latitude,longitude:t.longitude,iconPath:"../../static/images/icon_marker.png",width:34,height:34,callout:{content:t.name,padding:5,borderRadius:4,fontSize:13,display:"ALWAYS"}}})),e.mescroll.endSuccess(a.length,i)})).catch((function(t){e.mescroll.endBySize()}))},onCall:function(t){uni.makePhoneCall({phoneNumber:t})},getLocation:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,uni.getLocation({type:"gcj02"});case 2:if(n=e.sent,a=(0,i.default)(n,2),a[0],r=a[1],r){e.next=8;break}return e.abrupt("return",t.getAuthorize());case 8:return e.abrupt("return",{latitude:r.latitude,longitude:r.longitude});case 9:case"end":return e.stop()}}),e)})))()},getAuthorize:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var n,a,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,uni.showModal({title:"您已拒绝地理位置权限",content:"是否进入权限管理，调整授权？"});case 2:if(n=e.sent,a=(0,i.default)(n,2),a[0],a[1],!data.confirm){e.next=16;break}return e.next=9,uni.openSetting();case 9:r=e.sent,s=(0,i.default)(r,2),s[0],o=s[1],o&&t.getLocation(),e.next=17;break;case 16:data.cancel&&t.$Router.back();case 17:case"end":return e.stop()}}),e)})))()},onSelect:function(t){uni.$emit("changeStore",t),this.$Router.back()}},onLoad:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getLocation();case 3:if(n=e.sent,n){e.next=6;break}throw new Error("位置获取失败");case 6:t.location=n,setTimeout((function(){t.mescroll.resetUpScroll()}),200),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0),t.$toast({title:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()}};e.default=l},7692:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={mescrollUni:n("fc25").default,uIcon:n("e466").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"store-list",class:t.themeName},[t.location.latitude?n("v-uni-map",{staticStyle:{width:"750rpx",height:"400rpx"},attrs:{"show-location":!0,latitude:t.location.latitude,longitude:t.location.longitude,markers:t.markers}}):t._e(),n("v-uni-view",{staticClass:"store"},[n("mescroll-uni",{ref:"mescrollRef",attrs:{fixed:!1,down:{auto:!1},up:{noMoreSize:5,auto:!1,empty:{icon:"/static/images/empty/shop.png",tip:"暂无门店~",fixed:!0}}},on:{init:function(e){arguments[0]=e=t.$handleEvent(e),t.mescrollInit.apply(void 0,arguments)},down:function(e){arguments[0]=e=t.$handleEvent(e),t.downCallback.apply(void 0,arguments)},up:function(e){arguments[0]=e=t.$handleEvent(e),t.upCallback.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"p-20"},t._l(t.lists,(function(e,a){return n("v-uni-view",{key:a,staticClass:"store-item bg-white flex",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.onSelect(e)}}},[n("v-uni-view",{staticClass:"flex-1"},[n("v-uni-view",{staticClass:"m-b-20"},[n("v-uni-text",{staticClass:"bold lg black"},[t._v(t._s(e.name))]),n("v-uni-text",{staticClass:"muted xs m-l-10"},[t._v(t._s(e.distance))])],1),n("v-uni-view",{staticClass:"black xs m-b-20 flex"},[n("u-icon",{staticClass:"md m-r-10",attrs:{name:"map"}}),n("v-uni-text",[t._v(t._s(e.detailed_address))])],1),n("v-uni-view",{staticClass:"black xs flex"},[n("u-icon",{staticClass:"md m-r-10",attrs:{name:"clock"}}),n("v-uni-text",[t._v(t._s(e.business_start_time)+" - "+t._s(e.business_end_time))])],1)],1),n("v-uni-view",{on:{click:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.onCall(e.mobile)}}},[n("u-icon",{staticClass:"store-item-phone",attrs:{name:"phone-fill"}})],1)],1)})),1)],1)],1)],1)},r=[]},"833f":function(t,e,n){"use strict";n.r(e);var a=n("565d"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},"97a1":function(t,e,n){"use strict";n.r(e);var a=n("7692"),i=n("833f");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("aaea");var s,o=n("f0c5"),c=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"2bbc84fc",null,!1,a["a"],s);e["default"]=c.exports},aaea:function(t,e,n){"use strict";var a=n("55da"),i=n.n(a);i.a}}]);